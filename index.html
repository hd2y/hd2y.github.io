<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>华灯</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="盈月舞清风，华灯自摇曳。">
<meta property="og:type" content="website">
<meta property="og:title" content="华灯">
<meta property="og:url" content="https://hd2y.github.io/index.html">
<meta property="og:site_name" content="华灯">
<meta property="og:description" content="盈月舞清风，华灯自摇曳。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="hd2y">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="华灯" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">华灯</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hd2y.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-210406-map-json-file-to-entity-class" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/map-json-file-to-entity-class/" class="article-date">
  <time class="dt-published" datetime="2021-04-06T11:24:40.000Z" itemprop="datePublished">2021-04-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/map-json-file-to-entity-class/">映射 JSON 文件的实体类</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>想要使用接口返回的内容，直接生成实体类，用于后期开发。</p>
<p>如果简单使用可以参考：<a target="_blank" rel="noopener" href="http://tools.jb51.net/code/json2csharp/">http://tools.jb51.net/code/json2csharp/</a></p>
<p>但是因为其生成的属性名不规范，以及对于特殊属性名例如 <code>Fflag.appType.brands</code> 没有做好处理，所以自己写了一个工具类。</p>
<h2 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h2><p>首先需要引用 <code>Newtonsoft.Json</code>，<code>json</code> 文件的解析，以及生成实体的内容都依赖这个包。</p>
<p>另外为了处理单复数问题，还引用了 <code>PluralizeService.Core</code>。</p>
<p>工具类代码内容如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"><span class="keyword">using</span> Newtonsoft.Json.Linq;</span><br><span class="line"><span class="keyword">using</span> PluralizeService.Core;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Text.RegularExpressions;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Utils</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Json 工具类</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">JsonUtil</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 将 Json 内容转换为 C# 实体类</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;json&quot;&gt;</span>json 内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>转化后的实体类内容<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToEntityClass</span>(<span class="params"><span class="built_in">string</span> json</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> obj = JsonConvert.DeserializeObject(json);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> entities = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, EntityInfo&gt;();</span><br><span class="line">            MapEntityInfo(<span class="string">&quot;BaseEntity&quot;</span>, entities, obj <span class="keyword">as</span> JToken);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> content = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> entity <span class="keyword">in</span> entities)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 开始</span></span><br><span class="line">                content.AppendLine(<span class="string">$&quot;public class <span class="subst">&#123;PluralizationProvider.Singularize(GetPascalName(entity.Key))&#125;</span>&quot;</span>);</span><br><span class="line">                content.AppendLine(<span class="string">&quot;&#123;&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> property <span class="keyword">in</span> entity.Value.Properties)</span><br><span class="line">                &#123;</span><br><span class="line">                    content.AppendLine(<span class="string">$&quot;    [JsonProperty(\&quot;<span class="subst">&#123;property.Key&#125;</span>\&quot;)]&quot;</span>);</span><br><span class="line">                    content.AppendLine(<span class="string">$&quot;    public <span class="subst">&#123;GetTypeName(property.Value)&#125;</span> <span class="subst">&#123;GetPascalName(property.Key)&#125;</span> &#123;&#123; get; set; &#125;&#125;&quot;</span>);</span><br><span class="line">                    content.AppendLine();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 结束</span></span><br><span class="line">                content.AppendLine(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">                content.AppendLine();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> content.ToString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetTypeName</span>(<span class="params">PropertyInfo property</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="built_in">string</span> name = property.Type;</span><br><span class="line">            <span class="keyword">var</span> type = Type.GetType(name, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">var</span> typeNameMap = <span class="keyword">new</span> TypeNameMap();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">$&quot;<span class="subst">&#123;(property.IsArray ? <span class="string">&quot;List&lt;&quot;</span> : <span class="string">&quot;&quot;</span>)&#125;</span><span class="subst">&#123;(type != <span class="literal">null</span> ? (typeNameMap[type.Name] ?? type.Name) : PluralizationProvider.Singularize(GetPascalName(name)))&#125;</span><span class="subst">&#123;(property.Nullable &amp;&amp; type != <span class="literal">null</span> &amp;&amp; type.IsSubclassOf(<span class="keyword">typeof</span>(ValueType)) ? <span class="string">&quot;?&quot;</span> : <span class="string">&quot;&quot;</span>)&#125;</span><span class="subst">&#123;(property.IsArray ? <span class="string">&quot;&gt;&quot;</span> : <span class="string">&quot;&quot;</span>)&#125;</span>&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetPascalName</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(name)) <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 匹配 特殊字符+小写字母</span></span><br><span class="line">            <span class="keyword">var</span> regex = <span class="keyword">new</span> Regex(<span class="string">&quot;[^0-9a-zA-Z]+([0-9a-zA-Z]&#123;1&#125;)&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> matches = regex.Matches(name);</span><br><span class="line">            <span class="keyword">foreach</span> (Match match <span class="keyword">in</span> matches)</span><br><span class="line">            &#123;</span><br><span class="line">                name = name.Replace(match.Value, match.Result(<span class="string">&quot;$1&quot;</span>).ToUpper());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 移除非数字、字母的内容</span></span><br><span class="line">            name = <span class="keyword">new</span> Regex(<span class="string">&quot;[^0-9a-zA-Z]+&quot;</span>).Replace(name, <span class="built_in">string</span>.Empty);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 首字母转大写</span></span><br><span class="line">            <span class="keyword">if</span> (name.Length &gt; <span class="number">0</span>) name = <span class="built_in">string</span>.Concat(name.Substring(<span class="number">0</span>, <span class="number">1</span>).ToUpper(), name.Substring(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> EntityInfo <span class="title">MapEntityInfo</span>(<span class="params"><span class="built_in">string</span> name, Dictionary&lt;<span class="built_in">string</span>, EntityInfo&gt; entities, JToken token</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="comment">// 获取实体信息</span></span><br><span class="line">            <span class="keyword">if</span> (!entities.TryGetValue(name, <span class="keyword">out</span> EntityInfo entity))</span><br><span class="line">            &#123;</span><br><span class="line">                entity = <span class="keyword">new</span> EntityInfo();</span><br><span class="line">                entities.TryAdd(name, entity);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 实体的属性信息</span></span><br><span class="line">            <span class="keyword">var</span> properties = entity.Properties;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (token <span class="keyword">is</span> JObject obj)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 内容是对象时，需要获取属性信息</span></span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> kv <span class="keyword">in</span> obj)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> key = kv.Key;</span><br><span class="line">                    <span class="keyword">var</span> <span class="keyword">value</span> = kv.Value;</span><br><span class="line">                    <span class="keyword">if</span> (!properties.TryGetValue(key, <span class="keyword">out</span> PropertyInfo property))</span><br><span class="line">                    &#123;</span><br><span class="line">                        property = <span class="keyword">new</span> PropertyInfo();</span><br><span class="line">                        property.Name = key;</span><br><span class="line">                        properties.TryAdd(key, property);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">value</span> != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="keyword">value</span> <span class="keyword">is</span> JValue jValue)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">switch</span> (jValue.Type)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Integer:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(<span class="built_in">long</span>).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Float:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(<span class="built_in">decimal</span>).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Null:</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.String:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(<span class="built_in">string</span>).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Boolean:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(<span class="built_in">bool</span>).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Date:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(DateTime).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Guid:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(Guid).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.Uri:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(Uri).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="keyword">case</span> JTokenType.TimeSpan:</span><br><span class="line">                                    property.Type = <span class="keyword">typeof</span>(TimeSpan).FullName;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                <span class="literal">default</span>:</span><br><span class="line">                                    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;解析数值出现未知的数据类型！&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">value</span> <span class="keyword">is</span> JArray jArray)</span><br><span class="line">                        &#123;</span><br><span class="line">                            property.IsArray = <span class="literal">true</span>;</span><br><span class="line">                            property.Nullable = jArray.Any(a =&gt; a.Type == JTokenType.Null);</span><br><span class="line">                            <span class="keyword">if</span> (jArray.Count &gt; <span class="number">0</span> &amp;&amp; jArray.Any(a =&gt; a.Type != JTokenType.Null))</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">var</span> firstType = jArray.First(a =&gt; a.Type != JTokenType.Null).Type;</span><br><span class="line">                                <span class="keyword">if</span> (jArray.Any(a =&gt; a.Type != firstType &amp;&amp; a.Type != JTokenType.Null))</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;解析数组成员类型不唯一！&quot;</span>);</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">switch</span> (firstType)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Object:</span><br><span class="line">                                        property.Type = key;</span><br><span class="line">                                        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> jArray.Where(a =&gt; a.Type == JTokenType.Object))</span><br><span class="line">                                        &#123;</span><br><span class="line">                                            MapEntityInfo(key, entities, item);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Integer:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(<span class="built_in">long</span>).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Float:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(<span class="built_in">decimal</span>).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.String:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(<span class="built_in">string</span>).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Boolean:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(<span class="built_in">bool</span>).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Date:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(DateTime).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Guid:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(Guid).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.Uri:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(Uri).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="keyword">case</span> JTokenType.TimeSpan:</span><br><span class="line">                                        property.Type = <span class="keyword">typeof</span>(TimeSpan).FullName;</span><br><span class="line">                                        <span class="keyword">break</span>;</span><br><span class="line">                                    <span class="literal">default</span>:</span><br><span class="line">                                        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;解析数组出现未知的数据类型！&quot;</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            property.Type = key;</span><br><span class="line">                            MapEntityInfo(key, entities, <span class="keyword">value</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        property.Nullable = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> entity;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">EntityInfo</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Dictionary</span>&lt;<span class="title">string</span>, <span class="title">PropertyInfo</span>&gt; Properties</span> &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, PropertyInfo&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">PropertyInfo</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Type &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="keyword">typeof</span>(<span class="built_in">string</span>).FullName;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsArray &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> Nullable &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">TypeNameMap</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; typeNameMap = <span class="keyword">new</span>()</span><br><span class="line">        &#123;</span><br><span class="line">            [<span class="meta">typeof(bool).Name</span>] = <span class="string">&quot;bool&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(byte).Name</span>] = <span class="string">&quot;byte&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(sbyte).Name</span>] = <span class="string">&quot;sbyte&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(short).Name</span>] = <span class="string">&quot;short&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(ushort).Name</span>] = <span class="string">&quot;ushort&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(int).Name</span>] = <span class="string">&quot;int&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(uint).Name</span>] = <span class="string">&quot;uint&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(long).Name</span>] = <span class="string">&quot;long&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(ulong).Name</span>] = <span class="string">&quot;ulong&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(float).Name</span>] = <span class="string">&quot;float&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(double).Name</span>] = <span class="string">&quot;double&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(decimal).Name</span>] = <span class="string">&quot;decimal&quot;</span>,</span><br><span class="line">            [<span class="meta">typeof(string).Name</span>] = <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">internal</span> <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">string</span> name]</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                typeNameMap.TryGetValue(name, <span class="keyword">out</span> <span class="built_in">string</span> <span class="keyword">value</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>测试 <code>json</code> 内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;ProductInfoList&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;Sku&quot;</span>: <span class="string">&quot;58396277&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryFirstCode&quot;</span>: <span class="string">&quot;4841&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryFirstName&quot;</span>: <span class="string">&quot;家居和园艺&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryFirstNameEN&quot;</span>: <span class="string">&quot;Home &amp; Garden&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategorySecondCode&quot;</span>: <span class="string">&quot;48410020&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategorySecondName&quot;</span>: <span class="string">&quot;家装五金&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategorySecondNameEN&quot;</span>: <span class="string">&quot;Home Improvement&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryThirdCode&quot;</span>: <span class="string">&quot;484100206798&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryThirdName&quot;</span>: <span class="string">&quot;家庭安全&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CategoryThirdNameEN&quot;</span>: <span class="string">&quot;Home Security&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CnName&quot;</span>: <span class="string">&quot;英文字典迷你保险柜存钱盒大号钥匙款 蓝色 27*20*6.5CM&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;EnName&quot;</span>: <span class="string">&quot;Cute Simulation English Dictionary Style Mini Safety Storage Box Blue L&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;SpecLength&quot;</span>: <span class="number">27.50</span>,</span><br><span class="line">            <span class="attr">&quot;SpecWidth&quot;</span>: <span class="number">21.00</span>,</span><br><span class="line">            <span class="attr">&quot;SpecHeight&quot;</span>: <span class="number">7.50</span>,</span><br><span class="line">            <span class="attr">&quot;SpecWeight&quot;</span>: <span class="number">1120.00</span>,</span><br><span class="line">            <span class="attr">&quot;Published&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;IsClear&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;FreightAttrCode&quot;</span>: <span class="string">&quot;X0018&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;FreightAttrName&quot;</span>: <span class="string">&quot;普货&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;PlatformCommodityCode&quot;</span>: <span class="string">&quot;C13145463&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;CommodityWarehouseMode&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;GoodsImageList&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550097585_f535c1c5-5bea-4a83-8c43-00f325527a00.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550102897_18e38ad6-5f9e-46b6-ad67-f4847aa0c705.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/dcda886b-72c1-41d8-8f03-f712c1ab233f.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/ada5247f-9d95-46d7-8223-cc3ae733a89b.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550103366_12dbbb9d-0bc0-4154-a206-0f37a4011f23.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550109616_b993bbff-68e4-4b4d-8bba-fadcc07a1194.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/6f7fe5e7-6935-4062-8828-52bdc74feb01.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/bccf0963-319d-469e-b12b-541888df755a.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550110241_087e4b65-314e-4035-9eb3-5970d6192211.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550116960_a2932fc9-5fc2-4d6f-9552-4421ea6e79ff.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">2</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/2ca3f29f-775f-4b24-86b2-88bd778f11b1.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/ce3fd469-b08e-4364-a185-d13245b5ee57.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550117429_636348d8-aca3-4628-89c8-05aaf63be259.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550121022_2dcdc4c0-bcc3-412b-b242-450839220052.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/199bb9ce-9a48-4493-8d1d-a591e7c56cf7.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/54ed6d08-8b9f-4b9c-89ae-5f6c19e25c78.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550121491_8198fac2-13da-48a6-8286-afde185c7fba.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550127429_7153e854-d5f4-4ab2-a868-e1b6b22a480a.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">4</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/af946cc4-2e2a-4bfb-81e3-8ee4e0334d4f.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/c86dd714-0dab-477b-ab20-7e7246ee6003.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550128210_85dccec4-ebb7-48dd-b673-ffa9ed0ba5d0.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550131647_eadb06be-0400-46fb-b7c6-f104120c61e0.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">5</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/b2f9779f-c143-45a6-ac7c-a57170f1ebc6.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/c79e35bb-7ca5-4527-b60f-523a2990b863.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550132116_da004c50-bb32-4a7f-bcc6-9e431d21caf8.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550138678_169e8bc0-7f67-4c8e-88e3-6dfde45890e1.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">6</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/521e7c4e-68fb-4de7-ba6b-4b9029c7c160.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/18172593-beda-478c-b455-295672e1b3a4.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550139147_a80119d9-24f8-4da4-abc1-fbf4590090b8.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550142428_545ff06e-2db3-4988-b2b9-955d577b7449.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">7</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/ec9b4d9d-1fbf-4062-bad2-8f5c304affba.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/ea0690d1-9c53-4cdd-a912-aea15509689e.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550142897_eae670d9-9615-4e41-823a-7f1170c7283e.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550149616_7b451919-ee54-4ea2-a6db-32b7bb179317.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">8</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/045580ad-87fc-4be8-ab4a-c60cad68ee64.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/82412afb-0f76-47e0-bf60-82e4b85732ec.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550150397_226c7997-6b93-4f82-a7ae-ceeb40076dce.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;ThumbnailUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/202012081550157741_ea1c450b-5984-45d0-b126-43096e220325.JPG&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;Sort&quot;</span>: <span class="number">9</span>,</span><br><span class="line">                    <span class="attr">&quot;IsMainImage&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">                    <span class="attr">&quot;GooodsThumbnailList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">350</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/eaac56d0-1a00-4d2c-9950-0d6249031bd4.JPG&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;StandardLength&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardWidth&quot;</span>: <span class="number">600</span>,</span><br><span class="line">                            <span class="attr">&quot;StandardImageUrl&quot;</span>: <span class="string">&quot;https://img.goten.com/Resources/GoodsImages//2020/202012/dd6b6757-0dc5-41f3-995b-40dcb4775fbe.JPG&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;GoodsAttachmentList&quot;</span>: [],</span><br><span class="line">            <span class="attr">&quot;GoodsDescriptionList&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;Title&quot;</span>: <span class="string">&quot;Cute Simulation English Dictionary Style Mini Safety Storage Box Blue L&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;GoodsDescriptionKeywordList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;KeyWord&quot;</span>: <span class="string">&quot;Safety Box&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="attr">&quot;GoodsDescriptionLabelList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;LabelName&quot;</span>: <span class="string">&quot;英文&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="attr">&quot;GoodsDescriptionParagraphList&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;首段描述&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;STRONG&gt;Introductions:&lt;/STRONG&gt;&lt;BR&gt;Fantastic dictionary look makes this storage box rather distinctive from ordinary ones. Due to this feature, it can well protect your secrets without being found easily. Made with high-class material as well exquisite craftsmanship, this storage box is wear-resistant for long-term use. With quite spacious space, it allows you to put important things inside. Close and then place it on the book shelf, it seems to be a real English dictionary. Such a mini gadget can also be a good decoration for your room. Well, wanna give it a try? Just click to buy our Cute Simulation English Dictionary Style Mini Safety Storage Box!&lt;BR&gt;&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;特征&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">2</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;STRONG&gt;Features:&lt;/STRONG&gt;&lt;BR&gt;1. Specially designed into English dictionary style, quite mini and cute&lt;BR&gt;2. Great for deceiving the public so as to keep your belongings safe and unnoticed&lt;BR&gt;3. Made with first-rate material and exquisite workmanship, of great durability and reliability&lt;BR&gt;4. Compact size, lightweight and room-saving&lt;BR&gt;5. Hollow dictionary, can be used for storing important gadgets&lt;BR&gt;6. Also a nice decoration for room fitment&amp;nbsp;&amp;nbsp;&lt;BR&gt;&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;规格&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">3</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;P&gt;&lt;STRONG&gt;Specifications:&lt;/STRONG&gt;&lt;BR&gt;1. Material: Iron &amp;amp; ABS &amp;amp; Specialty Paper/Imitation Cloth&lt;BR&gt;2. Color: Blue&lt;BR&gt;3. Dimensions: (10.62 x 7.87 x 2.56)\&quot; / (27 x 20 x 6.5)cm (L x W x H)&lt;BR&gt;4. Weight: 35.27oz / 1000g&lt;/P&gt;\n&lt;P&gt;&amp;nbsp;&lt;/P&gt;&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;包装内含&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">4</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;STRONG&gt;Package Includes:&lt;/STRONG&gt;&lt;BR&gt;1 x English Dictionary Mini Safety Box&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;通用性&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">5</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="attr">&quot;ParagraphName&quot;</span>: <span class="string">&quot;附加信息&quot;</span>,</span><br><span class="line">                            <span class="attr">&quot;SortNo&quot;</span>: <span class="number">6</span>,</span><br><span class="line">                            <span class="attr">&quot;GoodsDescription&quot;</span>: <span class="string">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;CreateTime&quot;</span>: <span class="string">&quot;2018-03-12T12:31:20&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;UpdateTime&quot;</span>: <span class="string">&quot;2021-03-01T03:20:20&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;TortInfo&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;TortReasons&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">&quot;TortTypes&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">&quot;TortStatus&quot;</span>: <span class="number">2</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;IsProductAuth&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;ProductSiteModelList&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;SiteHosts&quot;</span>: <span class="string">&quot;www.gotenchina.com&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;WarehouseCodeList&quot;</span>: [</span><br><span class="line">                        <span class="string">&quot;SZ0001&quot;</span></span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;BrandName&quot;</span>: <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;PageIndex&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;TotalCount&quot;</span>: <span class="number">6656</span>,</span><br><span class="line">    <span class="attr">&quot;PageTotal&quot;</span>: <span class="number">666</span>,</span><br><span class="line">    <span class="attr">&quot;PageSize&quot;</span>: <span class="number">10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成的实体类内容：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BaseEntity</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;ProductInfoList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;ProductInfoList&gt; ProductInfoList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;PageIndex&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> PageIndex &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;TotalCount&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> TotalCount &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;PageTotal&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> PageTotal &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;PageSize&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> PageSize &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProductInfoList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;Sku&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Sku &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryFirstCode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryFirstCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryFirstName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryFirstName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryFirstNameEN&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryFirstNameEN &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategorySecondCode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategorySecondCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategorySecondName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategorySecondName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategorySecondNameEN&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategorySecondNameEN &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryThirdCode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryThirdCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryThirdName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryThirdName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CategoryThirdNameEN&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CategoryThirdNameEN &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CnName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CnName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;EnName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> EnName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SpecLength&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">decimal</span> SpecLength &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SpecWidth&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">decimal</span> SpecWidth &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SpecHeight&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">decimal</span> SpecHeight &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SpecWeight&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">decimal</span> SpecWeight &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;Published&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Published &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;IsClear&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsClear &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;FreightAttrCode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FreightAttrCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;FreightAttrName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FreightAttrName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;PlatformCommodityCode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> PlatformCommodityCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CommodityWarehouseMode&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> CommodityWarehouseMode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsImageList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GoodsImageList&gt; GoodsImageList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsAttachmentList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; GoodsAttachmentList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsDescriptionList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GoodsDescriptionList&gt; GoodsDescriptionList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;CreateTime&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> DateTime CreateTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;UpdateTime&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> DateTime UpdateTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;TortInfo&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> TortInfo TortInfo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;IsProductAuth&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsProductAuth &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;ProductSiteModelList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;ProductSiteModelList&gt; ProductSiteModelList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;BrandName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> BrandName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GoodsImageList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;ImageUrl&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> ImageUrl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;ThumbnailUrl&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> ThumbnailUrl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;Sort&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Sort &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;IsMainImage&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsMainImage &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GooodsThumbnailList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GooodsThumbnailList&gt; GooodsThumbnailList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GooodsThumbnailList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;StandardLength&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> StandardLength &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;StandardWidth&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> StandardWidth &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;StandardImageUrl&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> StandardImageUrl &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GoodsDescriptionList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;Title&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsDescriptionKeywordList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GoodsDescriptionKeywordList&gt; GoodsDescriptionKeywordList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsDescriptionLabelList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GoodsDescriptionLabelList&gt; GoodsDescriptionLabelList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsDescriptionParagraphList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;GoodsDescriptionParagraphList&gt; GoodsDescriptionParagraphList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GoodsDescriptionKeywordList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;KeyWord&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> KeyWord &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GoodsDescriptionLabelList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;LabelName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> LabelName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GoodsDescriptionParagraphList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;ParagraphName&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> ParagraphName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SortNo&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> SortNo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;GoodsDescription&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> GoodsDescription &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TortInfo</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;TortReasons&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> TortReasons &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;TortTypes&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> TortTypes &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;TortStatus&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> TortStatus &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProductSiteModelList</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;SiteHosts&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> SiteHosts &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">JsonProperty(<span class="meta-string">&quot;WarehouseCodeList&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; WarehouseCodeList &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/map-json-file-to-entity-class/" data-id="ckn5za8jb00gaz3rnhe1uebgk" data-title="映射 JSON 文件的实体类" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/json/" rel="tag">json</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210329-deploy-the-enterprise-knowledge-base-confluence" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/deploy-the-enterprise-knowledge-base-confluence/" class="article-date">
  <time class="dt-published" datetime="2021-03-29T07:11:00.000Z" itemprop="datePublished">2021-03-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/deploy-the-enterprise-knowledge-base-confluence/">部署企业知识库 Confluence</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、Docker-部署"><a href="#一、Docker-部署" class="headerlink" title="一、Docker 部署"></a>一、Docker 部署</h2><p>Confluence Docker Hub：<a target="_blank" rel="noopener" href="https://hub.docker.com/r/cptactionhank/atlassian-confluence">https://hub.docker.com/r/cptactionhank/atlassian-confluence</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建容器</span></span><br><span class="line"><span class="comment"># 映射端口如果被占用可以调整例如 18090:8090</span></span><br><span class="line">docker run -d --name confluence -p 8090:8090 --user root:root cptactionhank/atlassian-confluence:latest</span><br></pre></td></tr></table></figure>
<h2 id="二、安装过程"><a href="#二、安装过程" class="headerlink" title="二、安装过程"></a>二、安装过程</h2><p>以下过程是在 Windows 下操作，将 Confluence 部署到 CentOS，需要拷贝文件或编辑文件，建议使用 <code>finalshell</code> 工具连接创建 SSH 连接。</p>
<h3 id="1-数据库"><a href="#1-数据库" class="headerlink" title="1. 数据库"></a>1. 数据库</h3><p>准备一个数据库，MySQL、PostgreSQL 等数据库均可，这里以 MySQL 为例，安装过程略。</p>
<p>首先需要调整 InnoDB 日志文件大小，Confluence 建议日志文件大小再 256M 以上。</p>
<p>在 Linux 下设置过程如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 暂停 MySQL 服务</span></span><br><span class="line">service mysqld stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除旧的日志文件</span></span><br><span class="line">rm -f /var/lib/mysql/ib_logfile*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑 my.cnf 调整 innodb_log_file_size=256M</span></span><br><span class="line">vim /etc/my.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新启动 MySQL</span></span><br><span class="line">service mysqld start</span><br></pre></td></tr></table></figure>
<p>然后就是创建数据库以及授权：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE `confluence` <span class="keyword">DEFAULT</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;confluence&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授权</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> confluence.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;confluence&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 登录 root 用户更改事务隔离级别</span></span><br><span class="line"><span class="comment">-- MySQL 8.x</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> transaction_isolation<span class="operator">=</span><span class="string">&#x27;READ-COMMITTED&#x27;</span>;</span><br><span class="line"><span class="comment">-- MySQL 5.x</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> tx_isolation<span class="operator">=</span><span class="string">&#x27;READ-COMMITTED&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="2-代理配置"><a href="#2-代理配置" class="headerlink" title="2. 代理配置"></a>2. 代理配置</h3><p>首先调整 Confluence 的 Tomcat 配置，默认使用 <code>HTTPS</code> 代理访问。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制配置文件</span></span><br><span class="line">docker cp confluence:/opt/atlassian/confluence/conf/server.xml /opt/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑配置文件 Connector 节点，修改为示例 HTTPS 代理部分的内容、</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#    &lt;Connector port=&quot;8090&quot; connectionTimeout=&quot;20000&quot; redirectPort=&quot;8443&quot;</span></span><br><span class="line"><span class="comment">#               maxThreads=&quot;48&quot; minSpareThreads=&quot;10&quot;</span></span><br><span class="line"><span class="comment">#               enableLookups=&quot;false&quot; acceptCount=&quot;10&quot; debug=&quot;0&quot; URIEncoding=&quot;UTF-8&quot;</span></span><br><span class="line"><span class="comment">#               protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span></span><br><span class="line"><span class="comment">#               scheme=&quot;https&quot; secure=&quot;true&quot; proxyName=&quot;&lt;subdomain&gt;.&lt;domain&gt;.com&quot; proxyPort=&quot;443&quot;/&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 注意需要修改 proxyName 属性为自己的域名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将配置文件覆盖回去</span></span><br><span class="line">docker cp /opt/server.xml confluence:/opt/atlassian/confluence/conf/server.xml</span><br></pre></td></tr></table></figure>
<p>这里使用 Caddy 进行代理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 Caddy 软件包</span></span><br><span class="line">yum install caddy -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 vim 编辑 Caddyfile</span></span><br><span class="line">vim /etc/caddy/conf.d/Caddyfile.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改配置文件，代理指定接口并且 HTTP 访问自动跳转到 HTTPS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># https://&lt;subdomain&gt;.&lt;domain&gt;.com &#123;</span></span><br><span class="line"><span class="comment">#  gzip</span></span><br><span class="line"><span class="comment">#  tls &lt;user&gt;@&lt;emaildomain&gt;.com</span></span><br><span class="line"><span class="comment">#  proxy / localhost:18090 &#123;</span></span><br><span class="line"><span class="comment">#   transparent</span></span><br><span class="line"><span class="comment">#  &#125;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># http://&lt;subdomain&gt;.&lt;domain&gt;.com &#123;</span></span><br><span class="line"><span class="comment">#  redir https://&lt;subdomain&gt;.&lt;domain&gt;.com&#123;url&#125;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 注意需要调整域名信息以及邮箱，邮箱用于自动是申请域名证书</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启自启 Caddy 服务</span></span><br><span class="line">systemctl <span class="built_in">enable</span> caddy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动 Caddy</span></span><br><span class="line">service caddy start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止运行 Caddy</span></span><br><span class="line">service caddy stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启 Caddy</span></span><br><span class="line">service caddy restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 Caddy 运行状态</span></span><br><span class="line">service caddy status</span><br></pre></td></tr></table></figure>
<h3 id="3-安装及破解"><a href="#3-安装及破解" class="headerlink" title="3. 安装及破解"></a>3. 安装及破解</h3><p>访问 <code>https://&lt;subdomain&gt;.&lt;domain&gt;.com</code> 执行以下安装流程。</p>
<p>安装页面可以调整语言，建议修改为中文。</p>
<ol>
<li><code>设置 Confluence</code> 选择 <code>产品安装</code>。</li>
<li><code>选择功能</code> 根据需求选择。</li>
<li><code>授权码</code> 过程见下方破解流程。<ul>
<li>下载授权工具：<a target="_blank" rel="noopener" href="https://pan.xunlei.com/s/VMSNMp0MczvkJfcam4CAxLXlA1">https://pan.xunlei.com/s/VMSNMp0MczvkJfcam4CAxLXlA1</a> 提取码：<code>zrv6</code>。</li>
<li>复制 jar 包：<code>docker cp confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar /opt/</code>。</li>
<li>打开授权工具：<code>java -jar confluence_keygen.jar</code>。</li>
<li>将授权页面的 <code>Server ID</code> 拷贝到授权工具中，并补充必填信息后点击 <code>.gen!</code> 按钮生成 Key。</li>
<li>将从容器中拷贝下来的 <code>atlassian-extras-decoder-v2-3.4.1.jar</code> 更名为 <code>atlassian-extras-2.4.jar</code>，然后点击 <code>.patch!</code> 进行破解。</li>
<li>当显示 <code>Jar successfully patched.</code> 表示破解成功，将破解后的文件名改回 <code>atlassian-extras-decoder-v2-3.4.1.jar</code>。</li>
<li>将文件拷贝回容器中覆盖原有文件：<code>docker cp /opt/atlassian-extras-decoder-v2-3.4.1.jar confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar</code>。</li>
<li>刷新页面，将授权工具生成的 Key 填入并继续。</li>
</ul>
</li>
<li><code>配置数据库</code> 选择 <code>我自己的数据库</code>。</li>
<li><code>设置你的数据库</code> 填写自己的数据库信息及密码，填写以后等待安装完成即可。</li>
</ol>
<p><strong>注意：</strong> 使用授权工具需要安装 Java。</p>
<h2 id="三、常用目录"><a href="#三、常用目录" class="headerlink" title="三、常用目录"></a>三、常用目录</h2><ul>
<li>产品开发<ul>
<li>001-团队大纲</li>
<li>002-团队成员</li>
<li>003-新人指南</li>
<li>004-技术架构</li>
<li>005-会议纪要</li>
<li>006-团队规范</li>
<li>007-踩坑历程</li>
<li>008-业务梳理</li>
<li>009-部门团建</li>
<li>010-团队分享</li>
<li>011-业务小组</li>
<li>012-团队总结</li>
</ul>
</li>
</ul>
<blockquote>
<p>参考：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36154886/article/details/113246166">教你如何通过Docker安装配置知识管理系统：confluence</a></li>
</ul>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/deploy-the-enterprise-knowledge-base-confluence/" data-id="ckn5za8i900d7z3rn2xbb21s8" data-title="部署企业知识库 Confluence" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Confluence/" rel="tag">Confluence</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Wiki/" rel="tag">Wiki</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210302-debugging-web-service-services-using-fiddler" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/debugging-web-service-services-using-fiddler/" class="article-date">
  <time class="dt-published" datetime="2021-03-02T02:17:00.000Z" itemprop="datePublished">2021-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/debugging-web-service-services-using-fiddler/">使用 Fiddler 调试 WebService 服务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>近期一个老客户的古董级数据上传工具出现了问题，反映一个通过 <code>WebService</code> 进行数据通信的工具无法正常使用。</p>
<p>因为通信接口是旧版的，源码不太好找，并且该通信接口 <code>WebService</code> 服务地址配置后无法生效，不能进行本地调试。</p>
<p>为了尽快的锁定问题，考虑用 <code>HTTP</code> 转发的方式来排查问题产生原因，以下是问题处理的流程，供以后处理类似问题时参考。</p>
<h2 id="锁定问题原因"><a href="#锁定问题原因" class="headerlink" title="锁定问题原因"></a>锁定问题原因</h2><p>首先，我们需要出现问题的节点，通过日志文件可以看到错误提示中存在两个问题：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">由于目标计算机积极拒绝，无法连接。 127.0.0.1:3349</span><br><span class="line">System.Web.Services.Protocols.SoapException: 服务器无法处理请求。 ---&gt; System.NullReferenceException: 未将对象引用设置到对象的实例。</span><br><span class="line">   在 YunHuLIS.MacWS.MacInfo.SetItemSample(String instrument, String itemCode, String result, String seq, String barcode, DateTime datetime)</span><br><span class="line">   --- 内部异常堆栈跟踪的结尾 ---</span><br><span class="line">System.Web.Services.Protocols.SoapException: 服务器无法处理请求。 ---&gt; System.NullReferenceException: 未将对象引用设置到对象的实例。</span><br><span class="line">   在 YunHuLIS.MacWS.MacInfo.SetItemSample(String instrument, String itemCode, String result, String seq, String barcode, DateTime datetime)</span><br><span class="line">   --- 内部异常堆栈跟踪的结尾 ---</span><br><span class="line"> </span><br><span class="line">由于目标计算机积极拒绝，无法连接。 127.0.0.1:3349</span><br><span class="line">System.Web.Services.Protocols.SoapException: 服务器无法处理请求。 ---&gt; System.NullReferenceException: 未将对象引用设置到对象的实例。</span><br><span class="line">   在 YunHuLIS.MacWS.MacInfo.SetItemSample(String instrument, String itemCode, String result, String seq, String barcode, DateTime datetime)</span><br><span class="line">   --- 内部异常堆栈跟踪的结尾 ---</span><br><span class="line"> </span><br><span class="line">由于目标计算机积极拒绝，无法连接。 127.0.0.1:3349</span><br><span class="line">System.Web.Services.Protocols.SoapException: 服务器无法处理请求。 ---&gt; System.NullReferenceException: 未将对象引用设置到对象的实例。</span><br><span class="line">   在 YunHuLIS.MacWS.MacInfo.SetItemSample(String instrument, String itemCode, String result, String seq, String barcode, DateTime datetime)</span><br><span class="line">   --- 内部异常堆栈跟踪的结尾 ---</span><br><span class="line">System.Web.Services.Protocols.SoapException: 服务器无法处理请求。 ---&gt; System.NullReferenceException: 未将对象引用设置到对象的实例。</span><br><span class="line">   在 YunHuLIS.MacWS.MacInfo.SetItemSample(String instrument, String itemCode, String result, String seq, String barcode, DateTime datetime)</span><br><span class="line">   --- 内部异常堆栈跟踪的结尾 ---</span><br></pre></td></tr></table></figure>
<p>首先是使用 <code>Socket</code> 与仪器无法连接，其次 <code>WebService</code> 也有异常抛出。</p>
<p>经检查确认仪器的传输是否正常，网口是否能正常监听，确认抛出异常的部分日志，可能是当时仪器软件没有启动导致。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-01.png"></p>
<p>使用 <code>Socket Tool</code> 工具监听，可以看到接口可以正常连接：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-02.png"></p>
<p>至于 <code>WebService</code> 的问题，只能确认在调用 <code>SetItemSample</code> 方法时出现了问题。</p>
<h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><p>首先使用接口能够正常登录，可以确认现场访问 <code>WebService</code> 是正常的，不存在网络问题。</p>
<p>之前出现过入参出现 <code>0x00</code> 的字符，服务方法访问异常，经检查通信接口调用入参是正确的，方法不存在问题，那么可以断定就是 <code>SetItemSample</code> 方法内的业务有问题。</p>
<p>前文提到，目前接口内的服务是编译在源码中的，无法通过配置修改，正常的思路是找到源码修改成本地的服务地址或者反编译修改内部的服务地址，方便本地调试。</p>
<p>当然这里不推荐这样做，如果想以最快的速度锁定服务的问题，我们还可以将通信接口的请求转发到本地。</p>
<p>这时候就要祭出 <code>Fiddler</code> 了：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-03.png"></p>
<p>从下图可以看到，很多向 <code>WebService</code> 的请求 <code>500</code>（服务器内部错误），错误内容是内部抛出了：<code>System.NullReferenceException</code></p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-04.png"></p>
<p>这时，我们可以选择 <code>AutoResponder</code> 选项卡，设置转发的规则：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-05.png"></p>
<p>这时，我们的调试环境可以将抛出捕获的异常：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-06.png"></p>
<p>这时可以看到，<code>SoapHeader</code> 携带的用户信息，获取失败，所以抛出了异常。</p>
<p>经检查，问题发生在通信接口中，没有对用户账户的输入进行限制，<code>SoapHeader</code> 中的用户 账号信息中携带了空格。</p>
<p>而在服务中，登录时对空格进行了处理，但是后续调用其他服务方法时，服务却没有处理账号中的空格，导致了该问题的产生。</p>
<p>同样的，我们还可以通过 <code>Fiddler</code> 编辑我们的请求，来确认是否是因为 <code>SoapHeader</code> 的问题：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debugging-web-service-services-using-fiddler-07.png"></p>
<p>经验证，删除了登录账号中的空格，接口就可以正常使用了。</p>
<p>当然后续就是视情况，对出现问题的接口进行调整。祖传代码，维护时就会发现真的是什么妖魔鬼怪的代码都有啊。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/debugging-web-service-services-using-fiddler/" data-id="ckn5za8i800d3z3rn1v8geo46" data-title="使用 Fiddler 调试 WebService 服务" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fiddler/" rel="tag">Fiddler</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebService/" rel="tag">WebService</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210302-get-the-database-password-of-ruimei-system" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/get-the-database-password-of-ruimei-system/" class="article-date">
  <time class="dt-published" datetime="2021-03-02T01:05:00.000Z" itemprop="datePublished">2021-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/%E4%B8%9A%E5%8A%A1/">业务</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/get-the-database-password-of-ruimei-system/">获取瑞美系统数据库密码</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>瑞美单机版默认打包了其所有已经开发的仪器通信接口，并且包含一个配置文件，记录了软件安装后初始化的一些参数。</p>
<p>包括：labitem、labitemref、labiteminter、labitemval、labitemparam、labitemexp。</p>
<p>当前是打算写一个小工具，将瑞美内已经维护的这些参数，批量读取到我们的云检测数据库中，作为以后新增仪器的基础参数，方便未来维护仪器以及检验项目信息。</p>
<p>但是目前参数文件内的部分内容含义不明，需要通过瑞美的数据库表结构，完成这些内容的匹配。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>瑞美的软件可以在其官网下载：<a target="_blank" rel="noopener" href="http://www.ruimei.com.cn/p/softdownload/index.html">http://www.ruimei.com.cn/p/softdownload/index.html</a></p>
<p>这里建议下载《瑞美单机版 5.0》，解压可以得到安装文件：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-01.png"></p>
<p>安装时会提示选择安装的仪器型号，下拉列表实际提供的是 instr 文件夹内的子文件夹列表。</p>
<p>确认安装后，会拷贝对应文件夹内的通信接口程序，并读取其内的参数文件，向数据库添加默认的参数信息。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-02.png"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>安装以后即可启动瑞美程序，简单测试一下程序是否安装正常。</p>
<p>默认安装后没有登录密码，无需输入直接“登录”即可进入主界面。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-03.png"></p>
<p>启动时通信接口程序会同时启动，如果需要测试通信接口，密码为 <code>13311667706</code>。</p>
<p>然后就需要找到瑞美的数据库，打开接口根目录：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-04.png"></p>
<p>可以很清楚的看到了，<code>database</code> 内存放的就是其数据库文件，<code>dbdriver</code> 为其驱动文件，<code>E411</code> 则是主程序、通信接口文件所在的目录。</p>
<h2 id="反编译"><a href="#反编译" class="headerlink" title="反编译"></a>反编译</h2><blockquote>
<p>以下反编译操作仅供学习。</p>
</blockquote>
<p>网上检索了一些资料，并没有找到关于瑞美单机版数据库如何连接，只知道其使用的数据库是 <code>sybase</code>。</p>
<p>另外，查看了下 <code>ODBC</code>，发现安装后多出了一个名为 <code>lis2017</code> 的数据源。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-05.png"></p>
<p>而该数据库文件默认是带有密码，无法使用 <code>Windows 身份认证</code> 等认证方式进行登录。</p>
<p>而找到密码最简单的自然是通过反编译，查看程序里如何获取数据库身份认证信息。</p>
<p>这里推荐使用 <code>PBKiller</code> 进行反编译，反编译的程序可以选择瑞美的通信解码程序，也就是之前提到的 <code>instr</code> 内的程序。</p>
<p><code>PBKiller</code> 下载地址：<a target="_blank" rel="noopener" href="http://www.greenxf.com/soft/118706.html">http://www.greenxf.com/soft/118706.html</a></p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-06.png"></p>
<p><code>PBKiller</code> 查找内容使用体验不好，建议导出后使用 <code>Notepad++</code> 等文本工具检索。</p>
<p>因为猜测其用户名没有修改，默认为 <code>DBA</code>，在 <code>Notepad++</code> 中打开导出的所有文件，输入该关键字直接搜索“所有打开的文件”，可以很容易的找到其设置数据库连接信息的内容。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-07.png"></p>
<p>可以看到，其如果使用的数据库为 <code>lis2002</code> 时，密码为 <code>thisisapig</code>，否则密码为 <code>thisisaflyingpig</code>。</p>
<p>注：另外，开发接口时如果不知道接收到的内容如何解析，可以参考瑞美接口内的反编译内容，经研究发现 <code>wf_addresult</code> 为其保存解析结果的方法，可以查找该方法锁定解析的位置。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-08.png"></p>
<h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>首先需要启动数据库，可以运行瑞美根目录 <code>dbdriver</code> 文件夹下的 <code>dbeng9.exe</code> 程序，托管数据库文件。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-09.png"></p>
<p>如果程序成功启动，可以看到其显示托管的端口，上图显示端口为 <code>2638</code>。</p>
<p>数据库建议使用 <code>sybase central</code> 进行连接，下载地址：<a target="_blank" rel="noopener" href="http://www.121down.com/soft/softview-93247.html">http://www.121down.com/soft/softview-93247.html</a></p>
<p>该程序为绿色版，需要运行批处理脚本注册，如果无法正常启动，可以尝试运行 <code>卸载Sybase Central插件.bat</code> 脚本后，重新注册。</p>
<p>启动 <code>sybase central</code> 后，选择 <code>工具</code> → <code>连接</code> → <code>Sybase IQ</code>，标识标签下，用户输入 <code>DBA</code>，口令输入 <code>thisisaflyingpig</code>，数据库标签下，我们可以查找可供连接的服务器：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-10.png"></p>
<p>正常情况下,这时所有准备工作就完成了,右键连接的数据库,选择 <code>Open Interactive SQL</code> 可以打开 SQL 脚本编辑框:</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/get-the-database-password-of-ruimei-system-11.png"></p>
<blockquote>
<p>注意：  </p>
<ol>
<li>以上过程仅供学习。</li>
<li>部分单工、双工接口如果不想开发上位机接口，可以通过读写瑞美数据库数据实现。</li>
<li>瑞美单机版数据库使用版本比较低，印象中测试需要使用 <code>.NET Framework 2.0</code> 提供的驱动才能连接成功。</li>
<li>目前网络版使用比较多，使用的一般是 <code>SQL Server</code> 数据库，如果需要对接，建议直接向瑞美工程师申请，开放视图进行读取。</li>
</ol>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/get-the-database-password-of-ruimei-system/" data-id="ckn5za8i800d5z3rn4c688cvq" data-title="获取瑞美系统数据库密码" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LIS/" rel="tag">LIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%91%9E%E7%BE%8E/" rel="tag">瑞美</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210223-chinese-helper" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/chinese-helper/" class="article-date">
  <time class="dt-published" datetime="2021-02-23T08:29:00.000Z" itemprop="datePublished">2021-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/chinese-helper/">汉字帮助类——获取拼音与五笔简码</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>系统各类的数据字典、业务数据检索，普遍是通过下拉框实现，部分会提供模糊检索，但是很少会提供通过五笔或拼音首码来检索的方式。</p>
<p>在过去参与的系统设计中，发现对于计算机系统不熟悉、键盘操作不熟练的用户来说，提供五笔或拼音首码检索的方式，可以大幅度提高表单录入的速度。</p>
<p>本文主要介绍如果通过汉字信息，获取拼音、五笔首码的信息。</p>
<blockquote>
<p>字典数据的检索建议提供 ID、名称、代码、拼音首码、五笔首码 等方式，提升用户在表单录入时的录入速度。</p>
</blockquote>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>数据字典中的 ID、名称、代码 都是原生信息，很方便获取，但是 拼音首码 与 五笔首码 需要维护字典库存储用于生成数据字典。</p>
<p>目前已经通过 <code>百度汉语</code> 以及 <code>汉典网</code> 提取到基本汉字的信息，包括 拼音、五笔 等信息。</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17OOspKdKk5MJi3YT3Nhsjw">https://pan.baidu.com/s/17OOspKdKk5MJi3YT3Nhsjw</a>  密码: tgd1</p>
<h2 id="帮助类"><a href="#帮助类" class="headerlink" title="帮助类"></a>帮助类</h2><p>已经预先导出了一份包含 汉字、拼音首码、五笔首码 信息的文件。</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/14Z5waW6OIGo2_PMFf7cvow">https://pan.baidu.com/s/14Z5waW6OIGo2_PMFf7cvow</a>  密码: g37t</p>
<p>五笔与拼音首码获取帮助类，可以参考：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 拼音五笔帮助类</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">PinyinWubiHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="title">Dictionary</span>&lt;<span class="title">char</span>, (<span class="title">char</span>[] <span class="title">pinyin</span>, <span class="title">char</span>[] <span class="title">wubi</span>)&gt; _dicHanzi</span> = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">char</span>, (<span class="built_in">char</span>[] pinyin, <span class="built_in">char</span>[] wubi)&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">PinyinWubiHelper</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="built_in">string</span> text = Resource.chinese;</span><br><span class="line">        <span class="comment">// 记录没有五笔或拼音的字符，存在需要抛出异常</span></span><br><span class="line">        List&lt;<span class="built_in">char</span>&gt; listWubi = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;();</span><br><span class="line">        List&lt;<span class="built_in">char</span>&gt; listPinyin = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">string</span> hanzi <span class="keyword">in</span> text.Split(<span class="string">&#x27;\n&#x27;</span>, StringSplitOptions.RemoveEmptyEntries))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span>[] info = hanzi.Split(<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">            _dicHanzi.Add(info[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">                , (pinyin: info[<span class="number">2</span>].Split(<span class="string">&#x27;|&#x27;</span>, StringSplitOptions.RemoveEmptyEntries).Select(py =&gt; py[<span class="number">0</span>]).ToArray()</span><br><span class="line">                , wubi: info[<span class="number">1</span>].Split(<span class="string">&#x27;|&#x27;</span>, StringSplitOptions.RemoveEmptyEntries).Select(wb =&gt; wb[<span class="number">0</span>]).ToArray()));</span><br><span class="line">            <span class="keyword">if</span> (_dicHanzi[info[<span class="number">0</span>][<span class="number">0</span>]].wubi.Length == <span class="number">0</span>) listWubi.Add(info[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span> (_dicHanzi[info[<span class="number">0</span>][<span class="number">0</span>]].pinyin.Length == <span class="number">0</span>) listPinyin.Add(info[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (listWubi.Count &gt; <span class="number">0</span> || listPinyin.Count &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">$&quot;<span class="subst">&#123;(listWubi.Count &gt; <span class="number">0</span> ? <span class="string">$&quot;存在无五笔首码的字符：<span class="subst">&#123;<span class="built_in">string</span>.Concat(listWubi)&#125;</span>&quot;</span> : <span class="string">&quot;&quot;</span>)&#125;</span>\r\n<span class="subst">&#123;(listPinyin.Count &gt; <span class="number">0</span> ? <span class="string">$&quot;存在无拼音首码的字符：<span class="subst">&#123;<span class="built_in">string</span>.Concat(listPinyin)&#125;</span>&quot;</span> : <span class="string">&quot;&quot;</span>)&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取一段中文的五笔首码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>中文内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;length&quot;&gt;</span>期望返回五笔首码的最大长度，默认 20<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>处理后的五笔首码<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;<span class="built_in">string</span>&gt; <span class="title">GetWubiCode</span>(<span class="params"><span class="built_in">string</span> text, <span class="built_in">int</span> length = <span class="number">20</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        text = HandlingText(text, length);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(text))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 默认第一位首码时的内容并返回</span></span><br><span class="line">            <span class="keyword">var</span> def = text</span><br><span class="line">                .ToCharArray()</span><br><span class="line">                .Select(ch =&gt; _dicHanzi.ContainsKey(ch) ? _dicHanzi[ch].wubi[<span class="number">0</span>] : ch);</span><br><span class="line"> </span><br><span class="line">            <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">string</span>(<span class="params">def.ToArray(</span>))</span>;</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 记录迭代到指定位置时还未返回的所有可能</span></span><br><span class="line">            List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; list = <span class="keyword">new</span> List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; &#123; <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;() &#125;;</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 循环字符串的所有字符</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; text.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (_dicHanzi.ContainsKey(text[i]))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 当前字符存在首码</span></span><br><span class="line">                    <span class="built_in">char</span>[] wubi = _dicHanzi[text[i]].wubi;</span><br><span class="line">                    <span class="keyword">if</span> (wubi.Length &gt; <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 1. 存在多个首码，需要将每种可能的结果返回，并且更新所有组合的可能性</span></span><br><span class="line">                        <span class="comment">// 获取当前位置之后的默认字符，用于返回</span></span><br><span class="line">                        IEnumerable&lt;<span class="built_in">char</span>&gt; last = def.Take(i + <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 更新截止到当前字符之前的所有可能</span></span><br><span class="line">                        List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; update = <span class="keyword">new</span> List&lt;List&lt;<span class="built_in">char</span>&gt;&gt;();</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 循环截止到当前字符之前的所有可能</span></span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; list.Count; j++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// 循环当前字符的所有首码</span></span><br><span class="line">                            <span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; wubi.Length; k++)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">var</span> current = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;(list[j]) &#123; wubi[k] &#125;;</span><br><span class="line"> </span><br><span class="line">                                <span class="comment">// 将截至到当前位置的所有默认可能返回</span></span><br><span class="line">                                <span class="keyword">if</span> (k &gt; <span class="number">0</span>)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">var</span> result = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;(current);</span><br><span class="line">                                    result.AddRange(last);</span><br><span class="line">                                    <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">string</span>(<span class="params">result.ToArray(</span>))</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"> </span><br><span class="line">                                update.Add(current);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 可能性增加，需要更新</span></span><br><span class="line">                        list = update;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 2. 只存在一个首码，将当前字符的首码添加到内容中</span></span><br><span class="line">                        list.ForEach(l =&gt; l.Add(_dicHanzi[text[i]].wubi[<span class="number">0</span>]));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 当前字符不存在五笔首码，则将当前字符添加到内容中</span></span><br><span class="line">                    list.ForEach(l =&gt; l.Add(text[i]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 获取一段中文的拼音首码</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>中文内容<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;length&quot;&gt;</span>期望返回拼音首码的最大长度，默认 20<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>处理后的拼音首码<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;<span class="built_in">string</span>&gt; <span class="title">GetPinyinCode</span>(<span class="params"><span class="built_in">string</span> text, <span class="built_in">int</span> length = <span class="number">20</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        text = HandlingText(text, length);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(text))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 默认第一位首码时的内容并返回</span></span><br><span class="line">            <span class="keyword">var</span> def = text</span><br><span class="line">                .ToCharArray()</span><br><span class="line">                .Select(ch =&gt; _dicHanzi.ContainsKey(ch) ? _dicHanzi[ch].pinyin[<span class="number">0</span>] : ch);</span><br><span class="line"> </span><br><span class="line">            <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">string</span>(<span class="params">def.ToArray(</span>))</span>;</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 记录迭代到指定位置时还未返回的所有可能</span></span><br><span class="line">            List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; list = <span class="keyword">new</span> List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; &#123; <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;() &#125;;</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// 循环字符串的所有字符</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; text.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (_dicHanzi.ContainsKey(text[i]))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 当前字符存在首码</span></span><br><span class="line">                    <span class="built_in">char</span>[] pinyin = _dicHanzi[text[i]].pinyin;</span><br><span class="line">                    <span class="keyword">if</span> (pinyin.Length &gt; <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 1. 存在多个首码，需要将每种可能的结果返回，并且更新所有组合的可能性</span></span><br><span class="line">                        <span class="comment">// 获取当前位置之后的默认字符，用于返回</span></span><br><span class="line">                        IEnumerable&lt;<span class="built_in">char</span>&gt; last = def.Skip(i + <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 更新截止到当前字符之前的所有可能</span></span><br><span class="line">                        List&lt;List&lt;<span class="built_in">char</span>&gt;&gt; update = <span class="keyword">new</span> List&lt;List&lt;<span class="built_in">char</span>&gt;&gt;();</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 循环截止到当前字符之前的所有可能</span></span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; list.Count; j++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// 循环当前字符的所有首码</span></span><br><span class="line">                            <span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">0</span>; k &lt; pinyin.Length; k++)</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="keyword">var</span> current = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;(list[j]) &#123; pinyin[k] &#125;;</span><br><span class="line"> </span><br><span class="line">                                <span class="comment">// 将截至到当前位置的所有默认可能返回</span></span><br><span class="line">                                <span class="keyword">if</span> (k &gt; <span class="number">0</span>)</span><br><span class="line">                                &#123;</span><br><span class="line">                                    <span class="keyword">var</span> result = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;(current);</span><br><span class="line">                                    result.AddRange(last);</span><br><span class="line">                                    <span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">string</span>(<span class="params">result.ToArray(</span>))</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"> </span><br><span class="line">                                update.Add(current);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"> </span><br><span class="line">                        <span class="comment">// 可能性增加，需要更新</span></span><br><span class="line">                        list = update;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 2. 只存在一个首码，将当前字符的首码添加到内容中</span></span><br><span class="line">                        list.ForEach(l =&gt; l.Add(_dicHanzi[text[i]].pinyin[<span class="number">0</span>]));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// 当前字符不存在拼音首码，则将当前字符添加到内容中</span></span><br><span class="line">                    list.ForEach(l =&gt; l.Add(text[i]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 特殊字符字典</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Dictionary&lt;<span class="built_in">char</span>, <span class="built_in">char</span>&gt; _dicChar = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">char</span>, <span class="built_in">char</span>&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            [<span class="meta">&#x27;Ａ&#x27;</span>] = <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｂ&#x27;</span>] = <span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｃ&#x27;</span>] = <span class="string">&#x27;C&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｄ&#x27;</span>] = <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｅ&#x27;</span>] = <span class="string">&#x27;E&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｆ&#x27;</span>] = <span class="string">&#x27;F&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｇ&#x27;</span>] = <span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｈ&#x27;</span>] = <span class="string">&#x27;H&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｉ&#x27;</span>] = <span class="string">&#x27;I&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｊ&#x27;</span>] = <span class="string">&#x27;J&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｋ&#x27;</span>] = <span class="string">&#x27;K&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｌ&#x27;</span>] = <span class="string">&#x27;L&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｍ&#x27;</span>] = <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｎ&#x27;</span>] = <span class="string">&#x27;N&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｏ&#x27;</span>] = <span class="string">&#x27;O&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｐ&#x27;</span>] = <span class="string">&#x27;P&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｑ&#x27;</span>] = <span class="string">&#x27;Q&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｒ&#x27;</span>] = <span class="string">&#x27;R&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｓ&#x27;</span>] = <span class="string">&#x27;S&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｔ&#x27;</span>] = <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｕ&#x27;</span>] = <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｖ&#x27;</span>] = <span class="string">&#x27;V&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｗ&#x27;</span>] = <span class="string">&#x27;W&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｘ&#x27;</span>] = <span class="string">&#x27;X&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｙ&#x27;</span>] = <span class="string">&#x27;Y&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;Ｚ&#x27;</span>] = <span class="string">&#x27;Z&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ａ&#x27;</span>] = <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｂ&#x27;</span>] = <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｃ&#x27;</span>] = <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｄ&#x27;</span>] = <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｅ&#x27;</span>] = <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｆ&#x27;</span>] = <span class="string">&#x27;f&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｇ&#x27;</span>] = <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｈ&#x27;</span>] = <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｉ&#x27;</span>] = <span class="string">&#x27;i&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｊ&#x27;</span>] = <span class="string">&#x27;j&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｋ&#x27;</span>] = <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｌ&#x27;</span>] = <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｍ&#x27;</span>] = <span class="string">&#x27;m&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｎ&#x27;</span>] = <span class="string">&#x27;n&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｏ&#x27;</span>] = <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｐ&#x27;</span>] = <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｑ&#x27;</span>] = <span class="string">&#x27;q&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｒ&#x27;</span>] = <span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｓ&#x27;</span>] = <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｔ&#x27;</span>] = <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｕ&#x27;</span>] = <span class="string">&#x27;u&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｖ&#x27;</span>] = <span class="string">&#x27;v&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｗ&#x27;</span>] = <span class="string">&#x27;w&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｘ&#x27;</span>] = <span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｙ&#x27;</span>] = <span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;ｚ&#x27;</span>] = <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;０&#x27;</span>] = <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;１&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;２&#x27;</span>] = <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;３&#x27;</span>] = <span class="string">&#x27;3&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;４&#x27;</span>] = <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;５&#x27;</span>] = <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;６&#x27;</span>] = <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;７&#x27;</span>] = <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;８&#x27;</span>] = <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">            [<span class="meta">&#x27;９&#x27;</span>] = <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="comment">// 用于替换内容，保留数字、小写字母、大写字母、基本汉字、〇、全角数字、全角小写字母、全角大写字母</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Regex _regex = <span class="keyword">new</span> Regex(<span class="string">@&quot;[^0-9A-Za-z\u4E00-\u9FA5\u3007０-９ａ-ｚＡ-Ｚ]&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">HandlingText</span>(<span class="params"><span class="built_in">string</span> text, <span class="built_in">int</span> length = <span class="number">20</span></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(text)) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 将非数字字母汉字等移除</span></span><br><span class="line">        text = _regex.Replace(text, <span class="string">&quot;&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        List&lt;<span class="built_in">char</span>&gt; content = <span class="keyword">new</span> List&lt;<span class="built_in">char</span>&gt;();</span><br><span class="line">        <span class="comment">// 正则会移除高位字符，这里进行迭代已经不会出现高位字符被拆成两个特殊字符的情况</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="built_in">char</span> ch <span class="keyword">in</span> text)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 将特殊字符替换，例如全角字符替换为半角</span></span><br><span class="line">            <span class="keyword">if</span> (_dicChar.ContainsKey(ch))</span><br><span class="line">            &#123;</span><br><span class="line">                content.Add(_dicChar[ch]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                content.Add(ch);</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (content.Count &gt;= length) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>(content.ToArray()).ToUpper();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试代码如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;南京市长江大桥参观南京市长江大桥)!@$#ＡａＢｂＣｃ１２３AaBbCc123&quot;</span>;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;[<span class="subst">&#123;text&#125;</span>]&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;拼音：&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> py <span class="keyword">in</span> PinyinWubiHelper.GetPinyinCode(text, <span class="number">50</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(py);</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;五笔：&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> wb <span class="keyword">in</span> PinyinWubiHelper.GetWubiCode(text, <span class="number">50</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(wb);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 控制台输出内容：</span></span><br><span class="line"><span class="comment">// [南京市长江大桥参观南京市长江大桥)!@$#ＡａＢｂＣｃ１２３AaBbCc123]</span></span><br><span class="line"><span class="comment">// 拼音：</span></span><br><span class="line"><span class="comment">// NJSCJDQCGNJSCJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSZJDQCGNJSCJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSCJDQSGNJSCJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSZJDQSGNJSCJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSCJDQCGNJSZJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSCJDQSGNJSZJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSZJDQCGNJSZJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// NJSZJDQSGNJSZJDQAABBCC123AABBCC123</span></span><br><span class="line"><span class="comment">// 五笔：</span></span><br><span class="line"><span class="comment">// FYYTIDSCCFYYTIDSAABBCC123AABBCC123</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/chinese-helper/" data-id="ckn5za8g5005qz3rnd00w16hh" data-title="汉字帮助类——获取拼音与五笔简码" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%94%E7%AC%94/" rel="tag">五笔</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8B%BC%E9%9F%B3/" rel="tag">拼音</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B1%89%E5%AD%97/" rel="tag">汉字</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210223-how-to-process-images" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/how-to-process-images/" class="article-date">
  <time class="dt-published" datetime="2021-02-23T03:54:00.000Z" itemprop="datePublished">2021-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/how-to-process-images/">如何处理图片</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在实验室信息系统（LIS）中，除常见定量、定性、说明文本等结果外，图表、标本图片等也是常见的结果表现形式。</p>
<p>例如：血常规、电泳、病理、精子分析、阴道微生态、各种高倍镜镜检等。</p>
<p>常见的数据提供方式是 base64 编码的字节数组、图片路径、数据库二进制数据等，部分也需要根据仪器提供数据，LIS自行绘制折线图、柱状图。</p>
<p>这里以常见的图片提供方式，说明一些常见的图片处理。</p>
<h2 id="解析-Base64-图片"><a href="#解析-Base64-图片" class="headerlink" title="解析 Base64 图片"></a>解析 Base64 图片</h2><p>常见于血常规图片的处理，部分仪器需要设置位图传输、指定图片类型为位图。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</span><br><span class="line"><span class="built_in">string</span> base64Path = Path.Combine(desktop, <span class="string">&quot;base64.txt&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> base64 = File.ReadAllText(base64Path);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> binary = Convert.FromBase64String(base64);</span><br><span class="line"><span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream(binary))</span><br><span class="line"><span class="keyword">using</span> (Image image = Image.FromStream(stream))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> imagePath = Path.Combine(desktop, <span class="string">$&quot;WBC<span class="subst">&#123;image.GetExtension()&#125;</span>&quot;</span>);</span><br><span class="line">    image.Save(imagePath);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;原始图片大小：<span class="subst">&#123;binary.Length&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;保存到本地图片大小：<span class="subst">&#123;<span class="keyword">new</span> FileInfo(imagePath).Length&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 原始图片大小：89654</span></span><br><span class="line"><span class="comment">// 保存到本地图片大小：179254</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>base64 文件内容链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YPPJftih0YecJYys1Jenng">https://pan.baidu.com/s/1YPPJftih0YecJYys1Jenng</a>  密码: dbfu</p>
</blockquote>
<h2 id="图片压缩"><a href="#图片压缩" class="headerlink" title="图片压缩"></a>图片压缩</h2><p>如上面演示的代码，如果我们直接使用 <code>Image.Save()</code> 方法，由于 <code>GDI+</code> 的处理，所保存图片大小与原始大小比较有大概一倍的增长。</p>
<p>不过这个流程还是要做，因为这样解析另外一个目的是为了获取图片的格式，以及确保二进制内容存储的是图片内容。</p>
<p>所以以上为错误演示，确认可以正确被解析为图片、解析到图片格式后，应该直接保存字节数组的内容到文件即可，无需使用 <code>Image</code> 对象保存。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// image.Save(imagePath);</span></span><br><span class="line">File.WriteAllBytes(imagePath, binary);</span><br></pre></td></tr></table></figure>
<p>当然，以上的做法可以避免 GDI 绘图导致的图片增长，但是无法避免另外一个问题：原始图片就比较大。</p>
<p>常见的血常规图片因为是软件绘制，并且文件大小都在 100KB 以内，大小可以接受。</p>
<p>但是部分镜检的仪器，因为输出的是”照片“，所以普遍文件大小都以 MB 计。</p>
<p>但是作为要体现在报告单上的图片，系统并不需要太多的图片细节。而且太大的图片，还会影响报告单文件的大小，所以还需要对图片进行压缩。</p>
<p>其实 GDI 已经提供了一个获取图片缩略图的方法，已经封装到工具类中，可以直接使用：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</span><br><span class="line"><span class="built_in">string</span> base64Path = Path.Combine(desktop, <span class="string">&quot;base64.txt&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> base64 = File.ReadAllText(base64Path);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> binary = Convert.FromBase64String(base64);</span><br><span class="line"><span class="keyword">using</span> (MemoryStream stream = <span class="keyword">new</span> MemoryStream(binary))</span><br><span class="line"><span class="keyword">using</span> (Image image = Image.FromStream(stream))</span><br><span class="line"><span class="keyword">using</span> (Image thumb = image.GetThumbnail())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> imagePath = Path.Combine(desktop, <span class="string">$&quot;WBC<span class="subst">&#123;image.GetExtension()&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> thumbPath = Path.Combine(desktop, <span class="string">$&quot;WBC-EX<span class="subst">&#123;image.GetExtension()&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="comment">//image.Save(imagePath);</span></span><br><span class="line">    File.WriteAllBytes(imagePath, binary);</span><br><span class="line">    thumb.Save(thumbPath);</span><br><span class="line"> </span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;原始图片大小：<span class="subst">&#123;<span class="keyword">new</span> FileInfo(imagePath).Length&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;缩略图大小：<span class="subst">&#123;<span class="keyword">new</span> FileInfo(thumbPath).Length&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 原始图片大小：89654</span></span><br><span class="line"><span class="comment">// 缩略图大小：1501</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/how-to-process-images_1614063890713.png" alt="how-to-process-images"></p>
<p>可以看到，对于图片细节比较少的位图，图片可以从 88KB 缩小到不足 2K，而且由于没有设置缩略图尺寸，所以在软件中几乎看不到两张图的差异。</p>
<p>而对于大尺寸、高分辨率、细节比较多的图片，还可以进行如下处理：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</span><br><span class="line"><span class="built_in">string</span> imagePath = Path.Combine(desktop, <span class="string">&quot;原始图.jpg&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> thumbPath = Path.Combine(desktop, <span class="string">&quot;缩略图.jpg&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> (Image image = Image.FromFile(imagePath))</span><br><span class="line"><span class="keyword">using</span> (Image thumb = image.GetThumbnail(<span class="number">1000</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 必须指定保存时的缩略图格式，否则如果按位图输出将没有明显的压缩效果</span></span><br><span class="line">    thumb.Save(thumbPath, ImageFormat.Jpeg);</span><br><span class="line"> </span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;原始图片 尺寸：<span class="subst">&#123;image.Width&#125;</span>×<span class="subst">&#123;image.Height&#125;</span> 大小：<span class="subst">&#123;<span class="keyword">new</span> FileInfo(imagePath).Length&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;缩略图 尺寸：<span class="subst">&#123;thumb.Width&#125;</span>×<span class="subst">&#123;thumb.Height&#125;</span> 大小：<span class="subst">&#123;<span class="keyword">new</span> FileInfo(thumbPath).Length&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 原始图片 尺寸：2736×3648 大小：2652323</span></span><br><span class="line"><span class="comment">// 缩略图 尺寸：1000×1334 大小：98715</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>当然，优秀的压缩效果，也损失了大量的图片细节，具体如何使用要根据实际情况进行调整。</p>
</blockquote>
<h2 id="反色处理"><a href="#反色处理" class="headerlink" title="反色处理"></a>反色处理</h2><p>如缩略图演示的图片，部分图片为了方便在仪器软件展示，提供的图片为黑底，但是在报告单中不可能展示黑底的图片。</p>
<p>这时常规的做法为将图片进行反色处理（可以在图片编辑软件中使用 Ctrl+Shift+i 看到反色效果）。</p>
<p>同样反色也已经封装在工具类的扩展方法中，调用如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> desktop = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);</span><br><span class="line"><span class="built_in">string</span> imagePath = Path.Combine(desktop, <span class="string">&quot;WBC.bmp&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> invertPath = Path.Combine(desktop, <span class="string">&quot;WBC-EX.bmp&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> (Image image = Image.FromFile(imagePath))</span><br><span class="line"><span class="keyword">using</span> (Image invertImage = image.InvertColors())</span><br><span class="line">&#123;</span><br><span class="line">    invertImage.Save(invertPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/how-to-process-images-02_1614066320084.png" alt="how-to-process-images-02"></p>
<h2 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h2><p>常见绘制的图片为柱状图、散点图，可以参考文章：<a target="_blank" rel="noopener" href="https://www.hd2y.net/archives/picture-drawing-of-beckman-dxh800-blood-cell-instrument">贝克曼 DxH800 血球仪图片绘制问题</a></p>
<p>附常用图片相关扩展方法：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Drawing;</span><br><span class="line"><span class="keyword">using</span> System.Drawing.Imaging;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">JohnSun.Util</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> Image 扩展方法</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ImageExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图形的字节数组内容</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;image&quot;&gt;</span>原始图片<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;format&quot;&gt;</span>图片格式<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>图片的内容<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">GetBytes</span>(<span class="params"><span class="keyword">this</span> Image image, ImageFormat format = <span class="literal">default</span></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> stream = <span class="keyword">new</span> MemoryStream())</span><br><span class="line">            &#123;</span><br><span class="line">                image.Save(stream, <span class="keyword">new</span> ImageFormat((format ?? image.RawFormat).Guid));</span><br><span class="line">                <span class="keyword">return</span> stream.ToArray();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图形的反色内容</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;image&quot;&gt;</span>原始图片<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>反色的图形，同画图工具中 Ctrl+Shift+I 快捷键反色的效果<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Image <span class="title">InvertColors</span>(<span class="params"><span class="keyword">this</span> Image image</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Bitmap bitmap = <span class="keyword">new</span> Bitmap(image);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> x = <span class="number">0</span>; x &lt; bitmap.Width; x++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> y = <span class="number">0</span>; y &lt; bitmap.Height; y++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> pixel = bitmap.GetPixel(x, y);</span><br><span class="line">                    <span class="keyword">var</span> invertPixel = Color.FromArgb(<span class="number">0xff</span> - pixel.R, <span class="number">0xff</span> - pixel.G, <span class="number">0xff</span> - pixel.B);</span><br><span class="line">                    bitmap.SetPixel(x, y, invertPixel);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> bitmap;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图像缩略图</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;image&quot;&gt;</span>原始图像<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;width&quot;&gt;</span>缩略图宽度，默认为原图宽度，如果只设置了高度会等比缩放<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;height&quot;&gt;</span>缩略图高度，默认为原图高度，如果只设置了宽度会等比缩放<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回缩略图<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Image <span class="title">GetThumbnail</span>(<span class="params"><span class="keyword">this</span> Image image, <span class="built_in">int</span> width = <span class="literal">default</span>, <span class="built_in">int</span> height = <span class="literal">default</span></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (width &lt;= <span class="number">0</span>) width = height &lt;= <span class="number">0</span> ? image.Width : (<span class="built_in">int</span>)Math.Ceiling(image.Width * (height / (<span class="built_in">decimal</span>)image.Height));</span><br><span class="line">            <span class="keyword">if</span> (height &lt;= <span class="number">0</span>) height = (<span class="built_in">int</span>)Math.Ceiling(image.Height * (width / (<span class="built_in">decimal</span>)image.Width));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> image.GetThumbnailImage(width, height, <span class="keyword">new</span> Image.GetThumbnailImageAbort(() =&gt; <span class="literal">true</span>), IntPtr.Zero);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图片的原始格式</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;image&quot;&gt;</span>原始图像<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回 ImageFormat 属性中已确定的格式<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ImageFormat <span class="title">GetRawFormat</span>(<span class="params"><span class="keyword">this</span> Image image</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> image.RawFormat.GetRawFormat();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图片格式的后缀名</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;image&quot;&gt;</span>原始图像<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回后缀名，支持 ImageFormat 属性中已确定的格式<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetExtension</span>(<span class="params"><span class="keyword">this</span> Image image</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> image.RawFormat.GetExtension();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图片的原始格式</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;format&quot;&gt;</span>当前从图片中读取的格式<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回 ImageFormat 属性中已确定的格式<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ImageFormat <span class="title">GetRawFormat</span>(<span class="params"><span class="keyword">this</span> ImageFormat format</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (format.Equals(ImageFormat.MemoryBmp)) <span class="keyword">return</span> ImageFormat.MemoryBmp;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Bmp)) <span class="keyword">return</span> ImageFormat.Bmp;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Emf)) <span class="keyword">return</span> ImageFormat.Emf;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Wmf)) <span class="keyword">return</span> ImageFormat.Wmf;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Gif)) <span class="keyword">return</span> ImageFormat.Gif;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Jpeg)) <span class="keyword">return</span> ImageFormat.Jpeg;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Png)) <span class="keyword">return</span> ImageFormat.Png;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Tiff)) <span class="keyword">return</span> ImageFormat.Tiff;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Exif)) <span class="keyword">return</span> ImageFormat.Exif;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Icon)) <span class="keyword">return</span> ImageFormat.Icon;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> format;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 获取图片格式的后缀名</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;format&quot;&gt;</span>当前从图片中读取的格式<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>返回后缀名，支持 ImageFormat 属性中已确定的格式<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetExtension</span>(<span class="params"><span class="keyword">this</span> ImageFormat format</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (format.Equals(ImageFormat.MemoryBmp)) <span class="keyword">return</span> <span class="string">&quot;.bmp&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Bmp)) <span class="keyword">return</span> <span class="string">&quot;.bmp&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Emf)) <span class="keyword">return</span> <span class="string">&quot;.emf&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Wmf)) <span class="keyword">return</span> <span class="string">&quot;.wmf&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Gif)) <span class="keyword">return</span> <span class="string">&quot;.gif&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Jpeg)) <span class="keyword">return</span> <span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Png)) <span class="keyword">return</span> <span class="string">&quot;.png&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Tiff)) <span class="keyword">return</span> <span class="string">&quot;.tiff&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Exif)) <span class="keyword">return</span> <span class="string">&quot;.exif&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (format.Equals(ImageFormat.Icon)) <span class="keyword">return</span> <span class="string">&quot;.ico&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">$&quot;未知的图片格式：<span class="subst">&#123;format&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/how-to-process-images/" data-id="ckn5za8i600d0z3rnaqnu7ypi" data-title="如何处理图片" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GDI/" rel="tag">GDI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LIS/" rel="tag">LIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/" rel="tag">图片压缩</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210223-instrument-communication" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/instrument-communication/" class="article-date">
  <time class="dt-published" datetime="2021-02-23T01:44:37.000Z" itemprop="datePublished">2021-02-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/%E4%B8%9A%E5%8A%A1/">业务</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/instrument-communication/">检验仪器常见通信方案</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、串口"><a href="#一、串口" class="headerlink" title="一、串口"></a>一、串口</h2><h3 id="串口通信"><a href="#串口通信" class="headerlink" title="串口通信"></a>串口通信</h3><p>串口通信（Serial Communication）的概念非常简单，串口按位（bit）发送和接收字节的通信方式。</p>
<p>串口通信最重要的参数是波特率、数据位、停止位和奇偶校验，对于两个进行通信的端口，这些参数必须匹配。</p>
<p>RS-232 标准是电气通信中最常见的串行连接标准，所以工作中串口通信一般都是RS-232协议通信，而在系统中或一些调试工具中通信端口也会称之为COM口（Cluster communication port）即串行通信端口。</p>
<p>RS-232 是美国电子工业联盟（EIA）制定的串行数据通信的接口标准，原始编号全称是 EIA-RS-232（简称 232，RS232）。它被广泛用于计算机串行接口外设连接。</p>
<h3 id="RS-232-设置："><a href="#RS-232-设置：" class="headerlink" title="RS-232 设置："></a>RS-232 设置：</h3><p>串口号：所使用的串行接口。常见如 COM1、COM2。</p>
<p>波特率：是指从一设备发到另一设备的波特率，即每秒钟多少符號。典型的波特率是 300, 1200, 2400, 9600, 19200, 115200 等。一般通信两端设备都要设为相同的波特率，但有些设备也可设置为自动检测波特率。</p>
<p>校验位：是用来验证数据的正确性。常见如 NONE 、ODD 、EVEN。</p>
<p>数据位：数据位紧跟在起始位之后，是通信中的真正有效信息。数据位的位数由通信双方共同约定，一般可以是 6 位、7 位或 8 位，比如标准的 ASCII 码是 0 至 127（7 位），扩展的 ASCII 码是 0 至 255（8 位）。</p>
<p>停止位：停止位在最后，用以标志一个字符传送的结束，对应于逻辑 1（高电平）状态。停止位可以是 1 位、1.5 位或 2 位。</p>
<h3 id="硬件连接"><a href="#硬件连接" class="headerlink" title="硬件连接"></a>硬件连接</h3><p>实际连接中，我们可以通过设备后方的串口端口完成连接。</p>
<p>但是需要注意的是，建议由仪器工程师完成连接工作，LIS 开发人员再进行调试测试。</p>
<p>如果没有仪器工程师指导，自行连接，需要将连接的仪器和电脑关闭断电后再操作，否则可能因为连接时的电流，烧坏硬件设备。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-01-6e3bf374a85e4f6ea6c1b771d5a1bf13.png" alt="instrument-communication-01"></p>
<p>如上图为电脑上的串口端口，以及连接需要使用的线材。如果没有串口端口，可以考虑使用 USB 转串口的转接线，但是这类设备可能会因为驱动或兼容问题，不够稳定。</p>
<h3 id="软件驱动"><a href="#软件驱动" class="headerlink" title="软件驱动"></a>软件驱动</h3><p>在某些情况下，硬件连接将不适用。例如开发人员调试、仪器软件与 LIS 系统部署在同一台电脑，这时如果考虑购置双串口的电脑自然是不合理的。</p>
<p>建议可以考虑使用软件驱动，可以使用 VSPD 工具虚拟串口：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-02-e8782f4a7d28458aadabddf952c2a703.png" alt="instrument-communication-02"></p>
<h3 id="发送-接收数据"><a href="#发送-接收数据" class="headerlink" title="发送/接收数据"></a>发送/接收数据</h3><p>发送或接收数据这里建议使用一款名为【串口调试助手 SComAssistant V2.2】的工具。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-03-63889c1d5f4c402dacd3ca761a18c9f3.png" alt="instrument-communication-03"></p>
<p>该工具可以实现一些较为简单的数据收、发操作，基本能够满足需求，如果不满足需要还可以考虑 AccessPort 等工具。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-04-d3311182020a440eb2974f088161aa81.png" alt="instrument-communication-04"></p>
<p>推荐 AccessPort 工具的另外一个原因是，其还可以作为一个监控工具使用，即类似“抓包工具”来使用。</p>
<p>以上串口工具已经打包，可以直接下载: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1CqcharAtWJLifPI0dSRSQA">https://pan.baidu.com/s/1CqcharAtWJLifPI0dSRSQA</a>  密码: 5q2g</p>
<h2 id="二、网口"><a href="#二、网口" class="headerlink" title="二、网口"></a>二、网口</h2><h3 id="网口通信"><a href="#网口通信" class="headerlink" title="网口通信"></a>网口通信</h3><p>网口通信即通过以太网连接到仪器，进行数据的传输的通信方式。</p>
<p>因为绝大多数使用 TCP/IP 协议进行通信，所以一般指基于 TCP/IP 协议进行数据传输的通信方式。</p>
<p>而 Socket 通信与 TCP/IP 协议都是基础知识，这里不再展开叙述。</p>
<h3 id="硬件连接-1"><a href="#硬件连接-1" class="headerlink" title="硬件连接"></a>硬件连接</h3><p>网线连接网口这种很基础的知识，这里应该不用再赘述了。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-05-af7134a500384d22b56a276fd710b77f.png" alt="instrument-communication-05"></p>
<p>这里需要注意的是一个双网口电脑问题。</p>
<p>理论上仪器软件所在的电脑可以接入路由器，与 LIS 所在电脑在同一个局域网内，双方就可以通信。</p>
<p>但是部分仪器厂商会因为网络安全的问题，要求仪器软件不接入局域网，直接与 LIS 所在电脑直接连接。</p>
<p>这样仪器将会占用电脑的网口，所以只有采购双网口的电脑供 LIS 使用。</p>
<p>当然也可以考虑再采购一个外置网卡，但是考虑驱动与兼容性问题，建议采购时优先考虑双网口的电脑。</p>
<h3 id="发送-接收数据-1"><a href="#发送-接收数据-1" class="headerlink" title="发送/接收数据"></a>发送/接收数据</h3><p>网口的测试工具，这里推荐【TCP/UDP Socket 调试工具（Socket Tool）】：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-06-6ebf6691f3674ee8b60168ebebbfe5da.png" alt="instrument-communication-06"></p>
<p>另外还有 sokit 工具，体验也不错：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/instrument-communication-07-e8112bb987354fbc80bf6620da40f712.png" alt="instrument-communication-07"></p>
<p>如果需要抓包，这里推荐 wireshark，使用教程建议参考博客园文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mq0036/p/11187138.html">https://www.cnblogs.com/mq0036/p/11187138.html</a></p>
<p>以上网口工具已经打包，可以直接下载：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1SkbeDkbE0KN46Qp9ShNXuw">https://pan.baidu.com/s/1SkbeDkbE0KN46Qp9ShNXuw</a>  密码: cfhm</p>
<h3 id="三、其他"><a href="#三、其他" class="headerlink" title="三、其他"></a>三、其他</h3><p>一般主流仪器只会提供串口、网口两种通信方式。</p>
<p>但是如果是国产仪器，或者国内代理商对仪器软件进行了汉化，再或者实验室使用了第三方的 LIS 而且想保留，那么就可能需要考虑其他的对接方案。</p>
<p>例如希森美康血球仪国内代理商会安装 Laborman 与仪器连接，用户在没有使用 LIS 可以直接在该软件上出具报告。而如果需要与仪器连接就需要读取仪器输出的 cfd 后缀文件。</p>
<p>有些国内一些镜检仪器，软件上没有针对性的开发通信模块，而是提供数据库访问权限，让 LIS 直接读取他们软件的数据库。</p>
<p>而针对这些其他的连接方式，选择一个最简单、最稳定的选项即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/instrument-communication/" data-id="ckn5za8i700d1z3rn6xrkdnyo" data-title="检验仪器常见通信方案" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LIS/" rel="tag">LIS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%B2%E5%8F%A3/" rel="tag">串口</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-210219-back-in-2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/back-in-2020/" class="article-date">
  <time class="dt-published" datetime="2021-02-18T20:36:00.000Z" itemprop="datePublished">2021-02-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%97%A5%E5%BF%97/">日志</a>►<a class="article-category-link" href="/categories/%E6%97%A5%E5%BF%97/%E6%9D%82%E8%B0%88/">杂谈</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/back-in-2020/">回顾2020年</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>不知不觉已经在杭州工作了近一年，交接圈有了一些变化，认识了很多很 NICE 的小伙伴，也慢慢适应了杭州的生活节奏。</p>
<p>但是当前这份工作不甚满意，公司内后端技术栈 C#、PHP、Java 中，目前过的最惨的也就是 C# 了，所以想在正式离职一些，总结一下过去一年的经历。</p>
<h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><h3 id="归纳总结"><a href="#归纳总结" class="headerlink" title="归纳总结"></a>归纳总结</h3><p>之前工作的团队有线上的云课堂，可以学习公司中的各个产品，开发也有各种文档可以学习，甚至文档的生产与学习称为了工作中的一个指标。</p>
<p>新的这份工作也有在线的 Wiki，是使用 Atlassian 部署，但是明显上面的内容就没法系统性的阅读与学习。</p>
<p>接收这份工作的第一件事情，就是花了半个月的时间整理了一份产品手册，并且学习源码。</p>
<p>当然后面也了解到所属团队的人手不足，没有余力做这些事情，但是一个优秀的团队一定要重视各类文档的输出，不能害怕或抗拒做这件事情。</p>
<h3 id="团队-Leader"><a href="#团队-Leader" class="headerlink" title="团队 Leader"></a>团队 Leader</h3><p>领导可以不懂技术，但是一定要尊重团队成员的选择。</p>
<p>经历过领导与研发团队争论数据库应该用 <code>SQL Server</code> 还是 <code>MySQL</code>，技术栈是升级到 <code>ASP.NET Core</code> 还是守着 <code>ASP.NET MVC</code>，一个小工具到底用 <code>Windows Form</code> 还是 <code>WPF</code> 等。</p>
<p>感叹不怕领导不懂这些，就怕领导遵循他所了解到过时的经验，来限制产品的进步。</p>
<p>领导可以不懂业务，但是一定要重视新产品与新业务的调研。</p>
<p>过去一年碰到最多的情况就是，这个产品或这个功能我明天就要。</p>
<p>当然最后经过”讨价还价“，会把时间延长到一周或者半个月，但是最后的结果都不理想，甚至可能因为破坏了现有的业务流程，要花费几个月的时间去摆平后续的烂摊子。</p>
<p>领导可以不善言谈，但是一定要言而有信，注意自己的言行举止。</p>
<p>……</p>
<p>太多的牢骚就发到这吧。</p>
<h3 id="逆流程的重要性"><a href="#逆流程的重要性" class="headerlink" title="逆流程的重要性"></a>逆流程的重要性</h3><p>之前第一份工作是传统的 HIS 企业，所以为了满足用户需求与缓解运维压力，比较重视逆流程与重要数据的更新。</p>
<p>但是，目前这个工作，因为之前产品设计不重视逆流程的原因，过去一年在后台改了太多的数据。</p>
<p>当然，经过努力，我把所负责的产品，功能慢慢都补全了，但是与其他产品线对接，仍然会因为这个出现一些问题。</p>
<p>比如，已经同步的订单删除了，比如订单的状态在我负责的产品回退了但是其他产品不能回退，比如订单信息更新了没有通知导致各系统信息不对称等等。</p>
<p>当然其他研发和产品普遍认为，这个操作是不合适的所以不考虑添加类似的功能，但是日常业务的确需要这样操作，没办法，只能后台修改数据。</p>
<p>其实这些是可以通过权限控制来避免一些错误的操作的，至少要让客服主管和后台管理员有这部分权限，否则只能大半夜被电话骚扰起床改数据了。</p>
<h3 id="职责划分"><a href="#职责划分" class="headerlink" title="职责划分"></a>职责划分</h3><p>如果工作环境需要多个部门，多个团队协作，应该都经历过相互甩锅与扯皮。</p>
<p>大家都希望做简单的事情，都希望承担最少的责任获取最大的收益。</p>
<p>所以并不是技术栈越多越好，产品线越多越好，一切都要有一个度。</p>
<p>另外就是工作职责，如果公司不重视技术运维、产品实施、技术支持这些岗位，那研发工作的开展将会很难或者说很累。</p>
<h2 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h2><h3 id="健康"><a href="#健康" class="headerlink" title="健康"></a>健康</h3><p>一个比我还年轻些的小伙伴今年住院了，其实前年体检的时候对应的指标就不正常，没有重视。</p>
<p>虽然保险买了不用担心生病后给家里增加负担，但是也要重视自己的身体健康，定期做做体检。</p>
<p>另外，体重的问题也要重视，加油减掉身上的赘肉。</p>
<h3 id="心态"><a href="#心态" class="headerlink" title="心态"></a>心态</h3><p>目前最焦虑的事情就是患上了：拖延症……</p>
<p>克服、克服、再克服吧！！！</p>
<h2 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h2><h3 id="学习进阶"><a href="#学习进阶" class="headerlink" title="学习进阶"></a>学习进阶</h3><p>工作真的不能被编程语言困住，目前还停留在 C# 中，但是工作机会越来越少，是时候考虑学习一些新的编程语言。</p>
<p>目前考虑是 Java、Go 与 Rust，后续再根据需求做一些调整吧。</p>
<p>另外也要把当前用过的技术栈，系统性的学习一下，例如 Redis、Elasticsearch、RabbitMQ 等。</p>
<p>极客时间、慕课网刷起来吧。</p>
<p>另外，博客最近更新太少了，过去一年学了很多东西，也该总结一下了。</p>
<p>GitHub 的绿墙也该刷起来了。</p>
<h3 id="生活的计划"><a href="#生活的计划" class="headerlink" title="生活的计划"></a>生活的计划</h3><p>因为社保的原因，车子暂时不可能上浙A的牌照了，房子也要再努力努力，但是是时候脱单了。(逃</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/back-in-2020/" data-id="ckn5za8g3005mz3rn2s1rd62o" data-title="回顾2020年" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-201207-csharp-expression-script-evaluation-problems" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/csharp-expression-script-evaluation-problems/" class="article-date">
  <time class="dt-published" datetime="2020-12-06T16:24:40.000Z" itemprop="datePublished">2020-12-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/csharp-expression-script-evaluation-problems/">C# 中表达式计算问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>问题：计算公式为 <code>[A/G] = [ALB] / ([TP] - [ALB])</code>，已知 <code>[TP]</code> 与 <code>[ALB]</code> 的值，求得 <code>[A/G]</code>。</p>
<p>这是一个很简单的四则运算问题，下面将演示如何在 C# 代码中如何简单、高效的进行求解。</p>
<h2 id="一、解析算式"><a href="#一、解析算式" class="headerlink" title="一、解析算式"></a>一、解析算式</h2><p>首先，需要考虑的是如何将已知的内容，替换到表达式中，其实想必大家和我一样，想到了正则的替换：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 解析表达式内容</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;text&quot;&gt;</span>文本<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;values&quot;&gt;</span>需要替换的值<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>解析后的内容<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">Parse</span>(<span class="params"><span class="built_in">string</span> text, Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; values</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> regex = <span class="keyword">new</span> Regex(<span class="string">@&quot;\[.+?\]&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> regex.Replace(text, match =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> values[match.Value];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后可以进行简单的测试：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Fact</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ParseSuccess</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> text = <span class="string">&quot;[ALB] / ([TP] - [ALB])&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> values = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        &#123;<span class="string">&quot;[ALB]&quot;</span>, <span class="string">&quot;2.3&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;[TP]&quot;</span>, <span class="string">&quot;5.4&quot;</span>&#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> result = Expression.Parse(text, values);</span><br><span class="line">    Assert.Equal(<span class="string">&quot;2.3 / (5.4 - 2.3)&quot;</span>, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、进行运算"><a href="#二、进行运算" class="headerlink" title="二、进行运算"></a>二、进行运算</h2><p>内容替换完成后，需要解析以上字符串，获取运算结果。网上会有一些讲解，如何用算法解析，再进行运算。</p>
<p>但复杂的算法不是我们追求的，我们要的是在尽可能简单的前提下完成运算工作。</p>
<p>以下介绍的是一些易用，且代码非常简单的解决方案。</p>
<h3 id="1-使用-DataTable-的-Computer-方法"><a href="#1-使用-DataTable-的-Computer-方法" class="headerlink" title="1. 使用 DataTable 的 Computer 方法"></a>1. 使用 DataTable 的 Computer 方法</h3><p>DataTable 大家应该非常熟悉，而 Computer 如果有使用过 DataTable 的聚合函数，应该也了解这个方法。</p>
<p>这里也是利用了 Computer 方法支持四则运算的特点：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> DataTable _table = <span class="keyword">new</span> DataTable();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UseDataTableComputer</span>(<span class="params"><span class="built_in">string</span> exp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _table.Compute(exp, <span class="string">&quot;&quot;</span>).ToString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-使用数据库计算"><a href="#2-使用数据库计算" class="headerlink" title="2. 使用数据库计算"></a>2. 使用数据库计算</h3><p>数据库查询支持四则运算，这个是常识，所以同样的我们可以使用数据库查询获取四则运算结果。</p>
<p>如果采用这个方法，建议用 SQLite 的内存模式，不用担心数据库断连，导致查询出现问题。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SQLiteConnection _conn;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> SQLiteConnection _connection</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (_conn == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            _conn = <span class="keyword">new</span> SQLiteConnection(<span class="string">&quot;Data Source=:memory:;Version=3;&quot;</span>);</span><br><span class="line">            _conn.Open();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> _conn;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UseDatabase</span>(<span class="params"><span class="built_in">string</span> exp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> (SQLiteCommand command = <span class="keyword">new</span> SQLiteCommand(<span class="string">$&quot;select <span class="subst">&#123;exp&#125;</span>&quot;</span>, _connection))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> command.ExecuteScalar().ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上使用 NuGet 引用引用了 <code>System.Data.SQLite.Core</code>。</p>
</blockquote>
<h3 id="3-使用-JavaScript-解析"><a href="#3-使用-JavaScript-解析" class="headerlink" title="3. 使用 JavaScript 解析"></a>3. 使用 JavaScript 解析</h3><p>说到 JavaScript 运行代码段，肯定想到了 <code>eval</code> 这个方法，而在 C# 中其实有很多开源的 JavaScript 解释器，可以运行 JavaScript 代码。</p>
<p>下面就是使用 Jint 实现的一个解决方案：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> JsValue _jsValue = <span class="keyword">new</span> Engine().Execute(<span class="string">@&quot;function calc(exp) &#123; return eval(exp); &#125;&quot;</span>).GetValue(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UseJavaScript</span>(<span class="params"><span class="built_in">string</span> exp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> _jsValue.Invoke(exp).ToObject().ToString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上使用 NuGet 引用引用了 <code>Jint</code>。</p>
</blockquote>
<h3 id="4-使用-Math-NET-计算"><a href="#4-使用-Math-NET-计算" class="headerlink" title="4. 使用 Math.NET 计算"></a>4. 使用 <code>Math.NET</code> 计算</h3><p>如果有用 JavaScript 处理过一些复杂的数学问题，例如代数求解，应该知道 <code>algebra.js</code> 与 <code>math.js</code> 这两个库。</p>
<p>C# 同样有一个工具包，可以处理复杂的数学问题，就是 <a target="_blank" rel="noopener" href="https://github.com/mathnet">Math.NET Team (github.com)</a>。</p>
<p>而四则运算这样简单的问题自然不在话下，甚至感觉有点大材小用：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UseMathNet</span>(<span class="params"><span class="built_in">string</span> exp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> expression = SymbolicExpression.Parse(exp);</span><br><span class="line">    <span class="keyword">return</span> expression.Evaluate(<span class="literal">null</span>).RealValue.ToString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上使用 NuGet 引用引用了 <code>MathNet.Symbolics</code>。</p>
</blockquote>
<h3 id="5-使用-Liquid-计算"><a href="#5-使用-Liquid-计算" class="headerlink" title="5. 使用 Liquid 计算"></a>5. 使用 Liquid 计算</h3><p><code>liquid</code> 是一种开源的模板语言，类似 <code>Razor</code>，但是相对来说更简单、高效。</p>
<p>其支持四则运算，所以如果模板内容就是一个四则运算，输出的内容就是我们需要的结果：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">UseLiquid</span>(<span class="params"><span class="built_in">string</span> exp</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Template.Parse(<span class="string">$&quot;&#123;&#123;&#123;&#123;<span class="subst">&#123;exp&#125;</span>&#125;&#125;&#125;&#125;&quot;</span>).Render();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上使用 NuGet 引用引用了 <code>Scriban</code>。</p>
</blockquote>
<p><strong>注意：</strong> 以上使用的 <code>Jint</code>、<code>Math.NET</code>、<code>Scriban</code> 均在 GitHub 开源，如何使用也可以到 GitHub 了解，其实这里仅仅使用了它们最简单的一个功能，强烈推荐都了解一下，它们的功能在实际项目中还可以有更广泛的应用。</p>
<h2 id="三、测试"><a href="#三、测试" class="headerlink" title="三、测试"></a>三、测试</h2><p>xUnit 测试文件：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> Xunit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CalculationShould</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Theory</span>]</span><br><span class="line">    [<span class="meta">MemberData(nameof(TestData.List), MemberType = typeof(TestData))</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UseDataTableComputerPass</span>(<span class="params"><span class="built_in">string</span> exp, <span class="built_in">double</span> result</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">value</span> = Convert.ToDouble(Calculation.UseDataTableComputer(exp));</span><br><span class="line">        <span class="keyword">value</span> = Math.Round(<span class="keyword">value</span>, <span class="number">2</span>, MidpointRounding.AwayFromZero);</span><br><span class="line">        Assert.Equal(result, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Theory</span>]</span><br><span class="line">    [<span class="meta">MemberData(nameof(TestData.List), MemberType = typeof(TestData))</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UseDatabasePass</span>(<span class="params"><span class="built_in">string</span> exp, <span class="built_in">double</span> result</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">value</span> = Convert.ToDouble(Calculation.UseDatabase(exp));</span><br><span class="line">        <span class="keyword">value</span> = Math.Round(<span class="keyword">value</span>, <span class="number">2</span>, MidpointRounding.AwayFromZero);</span><br><span class="line">        Assert.Equal(result, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Theory</span>]</span><br><span class="line">    [<span class="meta">MemberData(nameof(TestData.List), MemberType = typeof(TestData))</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UseJavaScriptPass</span>(<span class="params"><span class="built_in">string</span> exp, <span class="built_in">double</span> result</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">value</span> = Convert.ToDouble(Calculation.UseJavaScript(exp));</span><br><span class="line">        <span class="keyword">value</span> = Math.Round(<span class="keyword">value</span>, <span class="number">2</span>, MidpointRounding.AwayFromZero);</span><br><span class="line">        Assert.Equal(result, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Theory</span>]</span><br><span class="line">    [<span class="meta">MemberData(nameof(TestData.List), MemberType = typeof(TestData))</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UseLiquidPass</span>(<span class="params"><span class="built_in">string</span> exp, <span class="built_in">double</span> result</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">value</span> = Convert.ToDouble(Calculation.UseLiquid(exp));</span><br><span class="line">        <span class="keyword">value</span> = Math.Round(<span class="keyword">value</span>, <span class="number">2</span>, MidpointRounding.AwayFromZero);</span><br><span class="line">        Assert.Equal(result, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Theory</span>]</span><br><span class="line">    [<span class="meta">MemberData(nameof(TestData.List), MemberType = typeof(TestData))</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UseMathNetPass</span>(<span class="params"><span class="built_in">string</span> exp, <span class="built_in">double</span> result</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">value</span> = Convert.ToDouble(Calculation.UseMathNet(exp));</span><br><span class="line">        <span class="keyword">value</span> = Math.Round(<span class="keyword">value</span>, <span class="number">2</span>, MidpointRounding.AwayFromZero);</span><br><span class="line">        Assert.Equal(result, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestData</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> List&lt;<span class="built_in">object</span>[]&gt; Data = <span class="keyword">new</span> List&lt;<span class="built_in">object</span>[]&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">object</span>[] &#123;<span class="string">&quot;1 + 2&quot;</span>, <span class="number">3.0</span>&#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">object</span>[] &#123;<span class="string">&quot;10.0 / (5 - 2)&quot;</span>, <span class="number">3.33</span>&#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">object</span>[] &#123;<span class="string">&quot;3.14&quot;</span>, <span class="number">3.14</span>&#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="built_in">object</span>[] &#123;<span class="string">&quot;1 + 2 * 3 / 4.0&quot;</span>, <span class="number">2.5</span>&#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;<span class="built_in">object</span>[]&gt; List =&gt; Data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/calc-test-2a7b61d2a7ae47bbab8a1d6dcaa7e1bc.png" alt="calc-test"></p>
<h2 id="四、优缺点"><a href="#四、优缺点" class="headerlink" title="四、优缺点"></a>四、优缺点</h2><p>谈优缺点之前，首先看一下性能，测试代码如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        BenchmarkRunner.Run&lt;CalculationBenchmark&gt;(<span class="keyword">new</span> DebugInProcessConfig());</span><br><span class="line"></span><br><span class="line">        Console.ReadKey();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">RPlotExporter</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CalculationBenchmark</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="built_in">string</span>&gt; _exps = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;1 + 2&quot;</span>, <span class="string">&quot;10.0 / (5 - 2)&quot;</span>, <span class="string">&quot;3.14&quot;</span>, <span class="string">&quot;1 + 2 * 3 / 4.0&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Benchmark</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">UseDatabase</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _exps.Select(exp =&gt; Calculation.UseDatabase(exp)).ToList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Benchmark</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">UseDataTableComputer</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _exps.Select(exp =&gt; Calculation.UseDataTableComputer(exp)).ToList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Benchmark</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">UseJavaScript</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _exps.Select(exp =&gt; Calculation.UseJavaScript(exp)).ToList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Benchmark</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">UseLiquid</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _exps.Select(exp =&gt; Calculation.UseLiquid(exp)).ToList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">Benchmark</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; <span class="title">UseMathNet</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> _exps.Select(exp =&gt; Calculation.UseMathNet(exp)).ToList();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果如下：</p>
<table>
<thead>
<tr>
<th>Method</th>
<th align="right">Mean</th>
<th align="right">Error</th>
<th align="right">StdDev</th>
</tr>
</thead>
<tbody><tr>
<td>UseDatabase</td>
<td align="right">20.287 us</td>
<td align="right">0.3213 us</td>
<td align="right">0.2848 us</td>
</tr>
<tr>
<td>UseDataTableComputer</td>
<td align="right">4.210 us</td>
<td align="right">0.0643 us</td>
<td align="right">0.1093 us</td>
</tr>
<tr>
<td>UseJavaScript</td>
<td align="right">20.248 us</td>
<td align="right">0.1872 us</td>
<td align="right">0.1659 us</td>
</tr>
<tr>
<td>UseLiquid</td>
<td align="right">110.420 us</td>
<td align="right">1.7733 us</td>
<td align="right">1.8974 us</td>
</tr>
<tr>
<td>UseMathNet</td>
<td align="right">12.116 us</td>
<td align="right">0.1938 us</td>
<td align="right">0.1813 us</td>
</tr>
</tbody></table>
<p>可以看到在性能测试中，<code>DataTable</code> 的 <code>Computer</code> 方法表现最好，但是，更推荐用 <code>UseJavaScript</code> 与 <code>UseMathNet</code>。</p>
<p>原因如下：</p>
<ol>
<li><code>UseDataTableComputer</code> 只支持四则运算，如果遇到指数、对数等情况则无法进行运算。</li>
<li><code>UseDatabase</code>  需要依赖数据库，另外如果遇到整数运算，例如 <code>10 / 3</code>，默认是整除，暂时没有找到好的解决方案处理这个问题，这也是为什么上面的例子中每个算式都有浮点数。</li>
<li><code>UseLiquid</code> 应用中感觉和 <code>UseJavaScript</code> 很相似，所以在 <code>UseJavaScript</code> 表现更好的前提下，更推荐用后者。</li>
<li><code>UseMathNet</code> 有更好的性能，并且支持在算式中使用一些常量，例如 <code>e</code>、<code>π</code>，运算符也支持指数符号 <code>^</code>，但是只能处理与数学相关的问题（不支持位运算）。</li>
<li><code>UseJavaScript</code> 更灵活而且更方便测试，有更好的扩展性，但是复杂的运算需要使用函数来处理，不如 <code>UseMathNet</code>  易读。</li>
</ol>
<blockquote>
<p>备注：目前我是用 JavaScript，因为公式不是由客户维护，所以不需要开发编辑器，所有计算公式纯粹靠手撸。<br>目前碰到过最复杂的一个计算公式是：<code>100 * Math.sqrt(-12 + 2.38 * Math.LN2([T4]) + 0.0626 * Math.LN2([CA125Ⅱ]))/(1 + Math.sqrt(-12 + 2.38 * Math.LN2([T4]) + 0.0626 * Math.LN2([CA125Ⅱ])))</code>。<br>当然应用中还涉及一些其他的问题，比如 <code>[GLB] = [TP] / [ALB]</code>，<code>[A/G] = [ALB] / [GLB]</code>，需要用到递归进行处理；计算项因为浮点数精度的问题，所有结果都要指定小数位数等。这个后面有时间再慢慢补。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/csharp-expression-script-evaluation-problems/" data-id="ckn5za8g1005iz3rn4rexayp1" data-title="C# 中表达式计算问题" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Jint/" rel="tag">Jint</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AD%A3%E5%88%99/" rel="tag">正则</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-201129-aspnet-core-001-source-code-compilation-and-debugging" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/aspnet-core-001-source-code-compilation-and-debugging/" class="article-date">
  <time class="dt-published" datetime="2020-11-29T12:34:56.000Z" itemprop="datePublished">2020-11-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a>►<a class="article-category-link" href="/categories/%E5%BC%80%E5%8F%91/C/ASP-NET-Core/">ASP.NET Core</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/aspnet-core-001-source-code-compilation-and-debugging/">ASP.NET Core - 001 源码编译与调试</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一、源码编译"><a href="#一、源码编译" class="headerlink" title="一、源码编译"></a>一、源码编译</h2><p>需要编译的源码的代码仓库有两个，一个是 <a target="_blank" rel="noopener" href="https://github.com/dotnet/aspnetcore">aspnetcore</a>，另外一个是 <a target="_blank" rel="noopener" href="https://github.com/dotnet/extensions">extensions</a>。</p>
<p>如果有代理，编译的过程比较简单，参考微软的文档进行编译即可。</p>
<ul>
<li><code>ASP.NET Core</code>：<a target="_blank" rel="noopener" href="https://github.com/dotnet/aspnetcore/blob/master/docs/BuildFromSource.md">Build ASP.NET Core from Source —— GitHub</a></li>
<li><code>.NET Extensions</code>：<a target="_blank" rel="noopener" href="https://github.com/dotnet/extensions/blob/master/docs/BuildFromSource.md">Build .NET Extensions from Source —— GitHub</a></li>
</ul>
<p>如果没有代理，那么整个编译流程可能非常慢，甚至无法正常进行，可以B站这个视频执行编译：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1964y1F7hQ">编译并调试 Asp.Net Core 源码 —— B站视频</a></p>
<p>如果使用代理软件，建议使用 Global（全局）代理，同时命令行与 Powershell 需要设置代理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CMD</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=http://127.0.0.1:7890 &amp; <span class="built_in">set</span> https_proxy=http://127.0.0.1:7890</span><br><span class="line"></span><br><span class="line"><span class="comment"># Powershell</span></span><br><span class="line"><span class="variable">$Env</span>:http_proxy=<span class="string">&quot;http://127.0.0.1:7890&quot;</span>;<span class="variable">$Env</span>:https_proxy=<span class="string">&quot;http://127.0.0.1:7890&quot;</span></span><br></pre></td></tr></table></figure>
<p>编译时可能出现的错误：<code>C4819</code> 或其他的错误。实际代码是没有问题的，是编码的锅，解决方案：系统编码设置使用 <code>UTF-8</code>：</p>
<blockquote>
<p>系统设置 → 时间和语言 → 语言 → 相关设置 → 管理语言设置 → 管理 → 更改系统区域设置 → 勾选：使用 Unicode UTF-8 提供全球语言支持</p>
</blockquote>
<p>设置以后重启系统即可，网上反馈设置后部分软件可能出现乱码，目前我没发现类似问题。但是，我第一次设置后，系统所有图标丢失，部分软件无法正常使用，但是取消选项又重新勾选了一次就正常了，如果像我一样出现问题，可以多设置几次试试。</p>
<blockquote>
<p>补：发现了一个小问题，登录穿越火线，频道名、房间名、游戏玩家昵称的中文不显示了。/(ㄒoㄒ)/~~</p>
</blockquote>
<h2 id="二、调试"><a href="#二、调试" class="headerlink" title="二、调试"></a>二、调试</h2><p>后续需要学习 <code>ASP.NET Core</code>，并深入了解其实现原理，所以肯定希望能够直接调试源码。</p>
<p>这里提供两个调试方案，第一个方案是借助调试工具 dnSpy 来进行调试，第二则是直接使用 Visual Studio 进行调试。</p>
<h3 id="1-dnSpy-反编译调试"><a href="#1-dnSpy-反编译调试" class="headerlink" title="1. dnSpy 反编译调试"></a>1. dnSpy 反编译调试</h3><p>首先需要下载 dnSpy：<a target="_blank" rel="noopener" href="https://github.com/dnSpy/dnSpy">dnSpy/dnSpy: .NET debugger and assembly editor (github.com)</a>，解压后可以直接打开。</p>
<p>然后我们可以随意创建一个 <code>ASP.NET Core</code> 的示例项目，打开 Visual Studio Code，创建一个 MVC 项目并编译。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet new mvc -n 002_Debug</span><br><span class="line">dotnet build</span><br></pre></td></tr></table></figure>
<p>找到生成的 <code>002_Debug.dll</code> 拖到 dnSpy 中，找到程序入口设置断点并运行，即可进入调试：</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debug-with-dnspy-8dddc8ba484d41b487ddd11bd554bcd3.png" alt="debug-with-dnspy"></p>
<h3 id="2-源服务器支持"><a href="#2-源服务器支持" class="headerlink" title="2. 源服务器支持"></a>2. 源服务器支持</h3><p>首先如果是使用 Visual Studio Code，设置 <code>launch.json</code> 文件，增加如下内容：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//关闭 “仅我的代码” 项</span></span><br><span class="line">&quot;justMyCode&quot;: false,</span><br><span class="line">&quot;symbolOptions&quot;: &#123;</span><br><span class="line">  <span class="comment">//查找并下载symbol文件</span></span><br><span class="line">  &quot;searchMicrosoftSymbolServer&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debug-with-vsc-7f07d5a6789c4356a83847d62bc689a0.png" alt="debug-with-vsc"></p>
<p>如果时使用 Visual Studio：</p>
<blockquote>
<p>选项 → 调试 → 常规 → 取消 “仅我的代码” 的勾选 → 勾选 “启用源链接支持”<br>选项 → 调试 → 符号 → 符号文件(.pdb)的位置 → 勾选 “Microsoft 符号服务器”</p>
</blockquote>
<p>配置完成后，调试时将会下载符号文件，可以正常调试 <code>ASP.NET Core</code> 的源代码。</p>
<p><img src="https://hd2y.oss-cn-beijing.aliyuncs.com/debug-with-vs-eb893b497ff2435b97be84efcca271ce.png" alt="debug-with-vs"></p>
<h3 id="3-使用源码调试"><a href="#3-使用源码调试" class="headerlink" title="3. 使用源码调试"></a>3. 使用源码调试</h3><p>首先是 <code>ASP.NET Core</code>，前文我们已经进行了编译，我们可以在 <code>\artifacts\installers\Debug</code> 找到 <code>aspnetcore-runtime-3.1.9-dev-win-x64.msi</code> 进行安装。</p>
<p>然后是 <code>.NET Extensions</code>，我们可以在项目中创建一个 <code>NuGet.config</code>，然后配置本地程序包源：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packageSources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">clear</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;local1&quot;</span> <span class="attr">value</span>=<span class="string">&quot;C:\Users\hd2y\code\extensions\artifacts\packages\Debug\Shipping&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;local2&quot;</span> <span class="attr">value</span>=<span class="string">&quot;C:\Users\hd2y\code\aspnetcore\artifacts\packages\Debug\Shipping&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">add</span> <span class="attr">key</span>=<span class="string">&quot;nuget.org&quot;</span> <span class="attr">value</span>=<span class="string">&quot;https://api.nuget.org/v3/index.json&quot;</span> <span class="attr">protocolVersion</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">packageSources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这时，运行程序进入调试，就可以通过单步调试进入 <code>ASP.NET Core</code> 的源码。</p>
<p>如果以上操作无法正常调试，可以 F12 查看对应的方法的程序集版本。</p>
<p>例如我的程序集版本是 <code>3.1.10</code>，而我编译的 <code>ASP.NET Core</code> 的版本是 <code>3.1.9</code>，调试就无法正常进入。</p>
<p>这里有两种解决方案，第一种是查看 <code>3.1.9</code> 的版本对应的 <code>.NET SDK</code> 的版本进行安装，然后指定引用程序集的版本：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Project</span> <span class="attr">Sdk</span>=<span class="string">&quot;Microsoft.NET.Sdk.Web&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TargetFramework</span>&gt;</span>netcoreapp3.1<span class="tag">&lt;/<span class="name">TargetFramework</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RootNamespace</span>&gt;</span>_002_Debug<span class="tag">&lt;/<span class="name">RootNamespace</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">PackageReference</span> <span class="attr">Include</span>=<span class="string">&quot;Microsoft.Extensions.Hosting&quot;</span> <span class="attr">Version</span>=<span class="string">&quot;3.1.9&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ItemGroup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>不指定版本的话，在我测试的时候不知道为什么转到定义程序集版本是 <code>3.1.8</code>，而不是文档中提到的 <code>3.1.9</code>。<br>直接指定会使用 <code>NuGet.config</code> 配置的本地程序包源，如果设置后发现仍旧不行，可能 NuGet 有缓存，需要在 选项 → NuGet 包管理器 → 常规 → 清除所有 NuGet 缓存。</p>
</blockquote>
<p>第二种方案是根据当前 <code>.NET SDK</code> 对应的 <code>ASP.NET Core</code> 版本，重新进行编译，具体版本对应关系可以查看 <code>.NET Core SDK</code> 的下载页：<a target="_blank" rel="noopener" href="https://dotnet.microsoft.com/download/dotnet-core/3.1">Download .NET Core 3.1 (Linux, macOS, and Windows) (microsoft.com)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://hd2y.github.io/aspnet-core-001-source-code-compilation-and-debugging/" data-id="ckn5za8g0005fz3rn5kjxd9u6" data-title="ASP.NET Core - 001 源码编译与调试" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GitHub/" rel="tag">GitHub</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/">开发</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/C/">C#</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/C/ASP-NET-Core/">ASP.NET Core</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/C/WPF/">WPF</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E4%B8%9A%E5%8A%A1/">业务</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E5%9F%BA%E7%A1%80/">基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/Oracle/">Oracle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/PostgreSQL/">PostgreSQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/SQL-Server/">SQL Server</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLite/">SQLite</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91/%E6%9D%82%E8%B0%88/">杂谈</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/MacOS/">MacOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E8%BD%AF%E4%BB%B6/">软件</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%BF%97/">日志</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%BF%97/%E5%85%AC%E5%91%8A/">公告</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%BF%97/%E5%BC%80%E7%AE%B1/">开箱</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%97%A5%E5%BF%97/%E6%9D%82%E8%B0%88/">杂谈</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/NET-Standard/" rel="tag">.NET Standard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOP/" rel="tag">AOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASCII/" rel="tag">ASCII</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ActiveX/" rel="tag">ActiveX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Attribute/" rel="tag">Attribute</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Autofac/" rel="tag">Autofac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BFG/" rel="tag">BFG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CCProxy/" rel="tag">CCProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Confluence/" rel="tag">Confluence</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DBeaver/" rel="tag">DBeaver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Expression/" rel="tag">Expression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fiddler/" rel="tag">Fiddler</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fody/" rel="tag">Fody</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GDI/" rel="tag">GDI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitHub/" rel="tag">GitHub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gitea/" rel="tag">Gitea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HIS/" rel="tag">HIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HongYang/" rel="tag">HongYang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDE/" rel="tag">IDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IE/" rel="tag">IE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jint/" rel="tag">Jint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Json/" rel="tag">Json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kindle/" rel="tag">Kindle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LIS/" rel="tag">LIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LODOP/" rel="tag">LODOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MVC/" rel="tag">MVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MacOS/" rel="tag">MacOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MahApps-Metro/" rel="tag">MahApps.Metro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/" rel="tag">Math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NHibernate/" rel="tag">NHibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nexus3/" rel="tag">Nexus3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note/" rel="tag">Note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NuGet/" rel="tag">NuGet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OOP/" rel="tag">OOP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SOA/" rel="tag">SOA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/" rel="tag">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shell/" rel="tag">Shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP/" rel="tag">TCP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Telegram/" rel="tag">Telegram</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TreeView/" rel="tag">TreeView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tuple/" rel="tag">Tuple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI/" rel="tag">UI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/" rel="tag">UML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/" rel="tag">Unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS/" rel="tag">VS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VSCode/" rel="tag">VSCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ValueTuple/" rel="tag">ValueTuple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WCF/" rel="tag">WCF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WPF/" rel="tag">WPF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebApi/" rel="tag">WebApi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebService/" rel="tag">WebService</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wiki/" rel="tag">Wiki</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WinForm/" rel="tag">WinForm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows-XP/" rel="tag">Windows XP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Xml/" rel="tag">Xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/decimal/" rel="tag">decimal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/frp/" rel="tag">frp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdbc/" rel="tag">jdbc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/json/" rel="tag">json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mstsc/" rel="tag">mstsc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%B2%E5%8F%A3/" rel="tag">串口</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%94%E7%AC%94/" rel="tag">五笔</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%90%86/" rel="tag">代理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" rel="tag">依赖注入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E7%BB%84/" rel="tag">元组</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E5%AF%86/" rel="tag">加密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/" rel="tag">动态链接库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%8D%E5%B0%84/" rel="tag">反射</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/" rel="tag">图片压缩</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A7%94%E6%89%98/" rel="tag">委托</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B4%E9%BE%84/" rel="tag">年龄</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">序列化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%83%E5%85%83/" rel="tag">弃元</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%93%E5%8D%B0/" rel="tag">打印</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%BC%E9%9F%B3/" rel="tag">拼音</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%BF%97/" rel="tag">日志</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/" rel="tag">构造函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/" rel="tag">析构函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%9A%E4%B8%BE/" rel="tag">枚举</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A3%E5%88%99/" rel="tag">正则</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B1%89%E5%AD%97/" rel="tag">汉字</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%9B%E5%9E%8B/" rel="tag">泛型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%91%9E%E7%BE%8E/" rel="tag">瑞美</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A1%80%E7%90%83%E4%BB%AA/" rel="tag">血球仪</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%A3%E6%9E%84%E5%87%BD%E6%95%B0/" rel="tag">解构函数</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E8%AF%95/" rel="tag">调试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%9D%E5%85%8B%E6%9B%BC/" rel="tag">贝克曼</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%BB%E5%8D%A1/" rel="tag">身份证读卡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6/" rel="tag">软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9C%E7%A8%8B/" rel="tag">远程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%97%AA%E9%80%80/" rel="tag">闪退</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE/" rel="tag">项目</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/NET-Standard/" style="font-size: 10px;">.NET Standard</a> <a href="/tags/AOP/" style="font-size: 10px;">AOP</a> <a href="/tags/ASCII/" style="font-size: 10px;">ASCII</a> <a href="/tags/ActiveX/" style="font-size: 10px;">ActiveX</a> <a href="/tags/Attribute/" style="font-size: 10px;">Attribute</a> <a href="/tags/Autofac/" style="font-size: 10px;">Autofac</a> <a href="/tags/BFG/" style="font-size: 10px;">BFG</a> <a href="/tags/CCProxy/" style="font-size: 10px;">CCProxy</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/Confluence/" style="font-size: 10px;">Confluence</a> <a href="/tags/DBeaver/" style="font-size: 12px;">DBeaver</a> <a href="/tags/Expression/" style="font-size: 10px;">Expression</a> <a href="/tags/Fiddler/" style="font-size: 10px;">Fiddler</a> <a href="/tags/Fody/" style="font-size: 10px;">Fody</a> <a href="/tags/GDI/" style="font-size: 12px;">GDI</a> <a href="/tags/Git/" style="font-size: 12px;">Git</a> <a href="/tags/GitHub/" style="font-size: 12px;">GitHub</a> <a href="/tags/Gitea/" style="font-size: 10px;">Gitea</a> <a href="/tags/HIS/" style="font-size: 12px;">HIS</a> <a href="/tags/HongYang/" style="font-size: 10px;">HongYang</a> <a href="/tags/IDE/" style="font-size: 10px;">IDE</a> <a href="/tags/IE/" style="font-size: 10px;">IE</a> <a href="/tags/JavaScript/" style="font-size: 12px;">JavaScript</a> <a href="/tags/Jint/" style="font-size: 12px;">Jint</a> <a href="/tags/Json/" style="font-size: 10px;">Json</a> <a href="/tags/Kindle/" style="font-size: 10px;">Kindle</a> <a href="/tags/LIS/" style="font-size: 20px;">LIS</a> <a href="/tags/LODOP/" style="font-size: 10px;">LODOP</a> <a href="/tags/MVC/" style="font-size: 10px;">MVC</a> <a href="/tags/MacOS/" style="font-size: 10px;">MacOS</a> <a href="/tags/MahApps-Metro/" style="font-size: 10px;">MahApps.Metro</a> <a href="/tags/Math/" style="font-size: 10px;">Math</a> <a href="/tags/NHibernate/" style="font-size: 10px;">NHibernate</a> <a href="/tags/Nexus3/" style="font-size: 10px;">Nexus3</a> <a href="/tags/Note/" style="font-size: 10px;">Note</a> <a href="/tags/NuGet/" style="font-size: 10px;">NuGet</a> <a href="/tags/OOP/" style="font-size: 10px;">OOP</a> <a href="/tags/Oracle/" style="font-size: 10px;">Oracle</a> <a href="/tags/SOA/" style="font-size: 16px;">SOA</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/Shell/" style="font-size: 10px;">Shell</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/Telegram/" style="font-size: 10px;">Telegram</a> <a href="/tags/TreeView/" style="font-size: 10px;">TreeView</a> <a href="/tags/Tuple/" style="font-size: 10px;">Tuple</a> <a href="/tags/UI/" style="font-size: 12px;">UI</a> <a href="/tags/UML/" style="font-size: 10px;">UML</a> <a href="/tags/Unity/" style="font-size: 10px;">Unity</a> <a href="/tags/VS/" style="font-size: 10px;">VS</a> <a href="/tags/VSCode/" style="font-size: 10px;">VSCode</a> <a href="/tags/ValueTuple/" style="font-size: 10px;">ValueTuple</a> <a href="/tags/WCF/" style="font-size: 12px;">WCF</a> <a href="/tags/WPF/" style="font-size: 10px;">WPF</a> <a href="/tags/WebApi/" style="font-size: 14px;">WebApi</a> <a href="/tags/WebService/" style="font-size: 16px;">WebService</a> <a href="/tags/Wiki/" style="font-size: 10px;">Wiki</a> <a href="/tags/WinForm/" style="font-size: 10px;">WinForm</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/Windows-XP/" style="font-size: 12px;">Windows XP</a> <a href="/tags/Xml/" style="font-size: 10px;">Xml</a> <a href="/tags/decimal/" style="font-size: 10px;">decimal</a> <a href="/tags/frp/" style="font-size: 10px;">frp</a> <a href="/tags/jdbc/" style="font-size: 10px;">jdbc</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/mstsc/" style="font-size: 10px;">mstsc</a> <a href="/tags/%E4%B8%B2%E5%8F%A3/" style="font-size: 12px;">串口</a> <a href="/tags/%E4%BA%94%E7%AC%94/" style="font-size: 10px;">五笔</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 12px;">代理</a> <a href="/tags/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/" style="font-size: 10px;">依赖注入</a> <a href="/tags/%E5%85%83%E7%BB%84/" style="font-size: 12px;">元组</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">加密</a> <a href="/tags/%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/" style="font-size: 10px;">动态链接库</a> <a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 10px;">反射</a> <a href="/tags/%E5%9B%BE%E7%89%87%E5%8E%8B%E7%BC%A9/" style="font-size: 10px;">图片压缩</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 18px;">多线程</a> <a href="/tags/%E5%A7%94%E6%89%98/" style="font-size: 10px;">委托</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E5%B9%B4%E9%BE%84/" style="font-size: 10px;">年龄</a> <a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 10px;">序列化</a> <a href="/tags/%E5%BC%83%E5%85%83/" style="font-size: 10px;">弃元</a> <a href="/tags/%E6%89%93%E5%8D%B0/" style="font-size: 10px;">打印</a> <a href="/tags/%E6%8B%BC%E9%9F%B3/" style="font-size: 10px;">拼音</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 10px;">日志</a> <a href="/tags/%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/" style="font-size: 10px;">构造函数</a> <a href="/tags/%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0/" style="font-size: 10px;">析构函数</a> <a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size: 10px;">枚举</a> <a href="/tags/%E6%AD%A3%E5%88%99/" style="font-size: 14px;">正则</a> <a href="/tags/%E6%B1%89%E5%AD%97/" style="font-size: 10px;">汉字</a> <a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 12px;">泛型</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 10px;">爬虫</a> <a href="/tags/%E7%91%9E%E7%BE%8E/" style="font-size: 12px;">瑞美</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 12px;">虚拟机</a> <a href="/tags/%E8%A1%80%E7%90%83%E4%BB%AA/" style="font-size: 10px;">血球仪</a> <a href="/tags/%E8%A7%A3%E6%9E%84%E5%87%BD%E6%95%B0/" style="font-size: 10px;">解构函数</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 12px;">设计模式</a> <a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 10px;">调试</a> <a href="/tags/%E8%B4%9D%E5%85%8B%E6%9B%BC/" style="font-size: 10px;">贝克曼</a> <a href="/tags/%E8%BA%AB%E4%BB%BD%E8%AF%81%E8%AF%BB%E5%8D%A1/" style="font-size: 10px;">身份证读卡</a> <a href="/tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 10px;">软件</a> <a href="/tags/%E8%BF%9C%E7%A8%8B/" style="font-size: 10px;">远程</a> <a href="/tags/%E9%97%AA%E9%80%80/" style="font-size: 10px;">闪退</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 10px;">项目</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/map-json-file-to-entity-class/">映射 JSON 文件的实体类</a>
          </li>
        
          <li>
            <a href="/deploy-the-enterprise-knowledge-base-confluence/">部署企业知识库 Confluence</a>
          </li>
        
          <li>
            <a href="/debugging-web-service-services-using-fiddler/">使用 Fiddler 调试 WebService 服务</a>
          </li>
        
          <li>
            <a href="/get-the-database-password-of-ruimei-system/">获取瑞美系统数据库密码</a>
          </li>
        
          <li>
            <a href="/chinese-helper/">汉字帮助类——获取拼音与五笔简码</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 hd2y<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>