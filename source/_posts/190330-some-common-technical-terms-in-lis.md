---
title: "LIS通讯常见的一些技术名词"
date: "2019/03/30 17:35:00"
updated: "2019/03/30 17:35:00"
permalink: "some-common-technical-terms-in-lis/"
tags:
 - LIS
 - HIS
categories:
 - [开发, 业务]
---

## 前言

实验室信息系统仪器接口，从名称上来看，就可以很明确的知道这是一个负责做数据交互的工具。

但是对于刚入门的人来说，面对很多专业的名词，这其实并不简单。

虽然负责接口开发两年了，但是我也不敢说以我粗陋的了解，介绍的一定准确，这里就抛砖引玉，介绍一些专业名词和知识，如有错漏请指点一二。

## HIS与LIS

这个词既然在看这篇文章，应该都不会陌生，这里摘录一下百度百科对于`HIS`和`LIS`的介绍，如果不了解的话可以参考一下：

> 医院管理和医疗活动中进行信息管理和联机操作的计算机应用系统,英文缩写HIS。HIS是覆盖医院所有业务和业务全过程的信息管理系统。按照学术界公认的MorrisF.Collen所给的定义，应该是：利用电子计算机和通讯设备，为医院所属各部门提供病人诊疗信息 ( Patient Care Information) 和行政管理信息(Administration Information)的收集(Collect)、存储(Store)、处理(Process) 、提取(Retrieve)和数据交换(Communicate) 的能力并满足授权用户 ( Authorized Users)的功能需求的平台。

> LIS全称Laboratory Information Management System，是专为医院检验科设计的一套实验室信息管理系统，能将实验仪器与计算机组成网络，使病人样品登录、实验数据存取、报告审核、打印分发，实验数据统计分析等繁杂的操作过程实现了智能化、自动化和规范化管理。有助于提高实验室的整体管理水平，减少漏洞，提高检验质量。

## 通信模式

### 手工

在没有检验信息系统(LIS)时，检验医师需要给病人出具书面的检验报告，一般都是将实验器材出具的结果，或者检验医师观察到的结果，抄录到纸上，或者人工录入到Excel、Word文档再打印，最后提供给病人和医生，作为诊断和治疗的依据，这就是手工。

当然有一些实验仪器，自带了简单的报告系统，可以直接出具检验报告，这个我们另说不在讨论范围之内。

### 单工

手工出具结果，就存在效率低、易错等问题，而且不方便实验数据统一管理。

而绝大多数实验仪器都提供了通信方案，可以将实验仪器内的数据发送到LIS，或者提供了固定的存储位置供LIS采集。

这种仪器向LIS传输结果，或者LIS主动采集实验结果，因为数据的提供是单向的，固定由仪器提供给LIS，所以称之为单工，开发出的数据接收或采集接口称之为单工接口。

### 双工

单工接口解决了抄录实验结果效率低、易错的问题，但是对于每天大量的标本与繁多的检验项目，在上机做实验时，检验医师仍可能出错，例如将不同病人的标本放置错误而导致检验结果混淆，或漏选、多选、错选检验项目浪费试剂或错失最佳的检验时间。

由于如今信息化建设的逐步完善，HIS与LIS间已经没有隔阂，LIS可以很轻易的访问到医生为病人开具的检验医嘱信息，而医嘱信息是可以与检验项目挂钩，所以LIS系统可以将检验项目直接提供给检验仪器。

一般这个过程是标本采集后粘贴条码，检验科扫描条码签收，同时从HIS获取到标本的检验医嘱信息。

LIS接口从LIS中，查询签收条码的检验信息，将条码绑定的检查项目分别发送到指定的检验仪器。

医生直接将标本放置到对应仪器上，检验自动开始。

仪器会扫描标本上的条码，匹配LIS接口发送到检验仪器的项目直接进行实验。中间无需检验医师操作仪器选择项目。

（如果没有匹配到，检验仪器一般会发送查询消息给LIS系统，LIS接口接收到查询请求也可以返回检查项目。）

实验完成后，仪器自动将结果推送到LIS。

这个数据双向通信的过程我们称之为双工，而具备这种功能的LIS接口我们称之为双工接口。

### 流水线

流水线其实已经应用的很多，但是我实际接触到的不过一两家，因为目前来说大多数还不是特别完善，流水线需要精心保养否则容易出现问题。

但是流水线的应用前景是特别好的，也是实现检验自动化所必须的。

流水线就是完全不需要人工干预检验，检验医师只需要在监控整个系统的正常运行，并对于一些异常的检验结果进行处置。

检验科签收标本后，放置到流水线，流水线将自动将标本进行前处理包括离心、分样后，由传送带传送到对应仪器进行检验。

当然能供流水线正常运行的基础，是LIS系统必须实现了双工接口，能及时的将检验项目发送到流水线中，再由流水线将检验信息向各仪器分发，实现了检验过程的全自动化。

## 常见的通信方式

为了方便数据传输，一般仪器都提供了至少一种通信的方案，这里我们简单做一下介绍。

### 串口

串口通讯是最常见的通信方案，但是也较容易出现问题，其对于线材、传输距离、通信环境的要求都比较高，而且出现问题比较难排查，所以一般在数据校验上要认真对待避免出错。

当然处理过程中，如果确认了接口程序不存在问题，也要敢于对硬件提出质疑，包括线材和通讯环境等。

### 网口

网口大家都不会陌生，因为基本都应该学过或接触过Socket通信。

使用网口实现通信一般使用双网口电脑与实验仪器直连，或是将仪器接入路由器局域网通信，但就要求局域网网络绝对稳定，否则极易出现问题。

而一般此类通信协议常见的是使用`TCP协议`，一般是接口作为服务端，监听来自仪器的请求。也有极少数使用`UDP协议`或`HTTP协议`。

### 文件

就是直接将数据写入到计算机硬盘指定位置，供第三方读取检验结果，一般是普通文本或 `*.csv` 格式文件，也有输出为 `*.xml` 或Excel文件的。

### 数据库

这个大家也不陌生，一般仪器软件是将实验数据写入到数据库中间表，或者提供视图供第三方读取，常见的使用微软的`SQL Server`数据库和`Access`数据库。

### USB

实际接触较少，一般是模拟串口进行数据通信，但是大部分由于驱动的问题极不稳定。

如果容易出现问题，建议联系仪器厂家沟通有没有其他通信方式，如果可以选择其他方式通信。

## 通讯协议

对于文件、数据库方式数据的交互基本比较简单，能够解读直接解析内容进行传输即可。

但是对于网口、串口这种通讯方式，没有一个固定的格式，很难区分怎样的数据是一份完整的结果。

而仪器厂家则会制定规则，并编写通讯协议，提供给LIS厂商参考，确定数据通信的格式，包括起始符，终止符，响应码，数据校验规则等。

这其中最常见的底层的通讯协议，也是国际上比较认可的通讯协议是 `ASTM` 协议与 `HL7` 协议，ASTM协议多见于串口通信，而HL7协议多见于网口通信。

当然也有一些厂商会在网口通信的情况下使用ASTM协议，这些也只是保证数据传输正确的一些通讯方案，不必诧异。
